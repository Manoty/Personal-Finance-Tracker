[0m07:51:18.799667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B030534410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B030535790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B030535610>]}


============================== 07:51:18.807083 | 20a00ab9-5df8-4f13-9cea-b62849654f2d ==============================
[0m07:51:18.807083 [info ] [MainThread]: Running with dbt=1.11.2
[0m07:51:18.809083 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'invocation_command': 'dbt seed', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\personal_finance_tracker\\personal_finance_tracker\\logs'}
[0m07:51:19.339805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20a00ab9-5df8-4f13-9cea-b62849654f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0305FD490>]}
[0m07:51:19.448828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20a00ab9-5df8-4f13-9cea-b62849654f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B02CD6B690>]}
[0m07:51:19.471765 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:51:19.942563 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m07:51:19.944556 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:51:19.948546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '20a00ab9-5df8-4f13-9cea-b62849654f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0318047D0>]}
[0m07:51:23.534728 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.personal_finance_tracker.marts
- models.personal_finance_tracker.staging
[0m07:51:23.544727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20a00ab9-5df8-4f13-9cea-b62849654f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B02F52FAD0>]}
[0m07:51:23.644214 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m07:51:23.655173 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m07:51:23.699079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20a00ab9-5df8-4f13-9cea-b62849654f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B031BEA8D0>]}
[0m07:51:23.700217 [info ] [MainThread]: Found 1 seed, 472 macros
[0m07:51:23.702215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20a00ab9-5df8-4f13-9cea-b62849654f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B03057E890>]}
[0m07:51:23.705331 [info ] [MainThread]: 
[0m07:51:23.706323 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:51:23.708320 [info ] [MainThread]: 
[0m07:51:23.709337 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:51:23.712307 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance'
[0m07:51:27.667364 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance"
[0m07:51:27.667364 [debug] [ThreadPool]: On list_personal_finance: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"personal_finance"'
    
  
  
[0m07:51:27.668359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:51:27.707399 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m07:51:27.709394 [debug] [ThreadPool]: On list_personal_finance: Close
[0m07:51:27.711390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_personal_finance, now create_personal_finance_main)
[0m07:51:27.712386 [debug] [ThreadPool]: Creating schema "database: "personal_finance"
schema: "main"
"
[0m07:51:27.725278 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m07:51:27.726279 [debug] [ThreadPool]: On create_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "create_personal_finance_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='personal_finance'
        and type='sqlite'
    
  
[0m07:51:27.727274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:51:27.729512 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:51:27.731507 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m07:51:27.732543 [debug] [ThreadPool]: On create_personal_finance_main: BEGIN
[0m07:51:27.733502 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:51:27.734536 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m07:51:27.735501 [debug] [ThreadPool]: On create_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "create_personal_finance_main"} */

    
    
        create schema if not exists "personal_finance"."main"
    
[0m07:51:27.737492 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m07:51:27.738523 [debug] [ThreadPool]: On create_personal_finance_main: COMMIT
[0m07:51:27.739845 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m07:51:27.740845 [debug] [ThreadPool]: On create_personal_finance_main: COMMIT
[0m07:51:27.741841 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:51:27.742872 [debug] [ThreadPool]: On create_personal_finance_main: Close
[0m07:51:27.744832 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance_main'
[0m07:51:27.754542 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m07:51:27.755541 [debug] [ThreadPool]: On list_personal_finance_main: BEGIN
[0m07:51:27.756501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:51:27.757927 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m07:51:27.758925 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m07:51:27.759923 [debug] [ThreadPool]: On list_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance_main"} */
select
      'personal_finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'personal_finance'
  
[0m07:51:27.785486 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m07:51:27.788478 [debug] [ThreadPool]: On list_personal_finance_main: ROLLBACK
[0m07:51:27.789476 [debug] [ThreadPool]: Failed to rollback 'list_personal_finance_main'
[0m07:51:27.790474 [debug] [ThreadPool]: On list_personal_finance_main: Close
[0m07:51:27.792467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20a00ab9-5df8-4f13-9cea-b62849654f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B031A9E610>]}
[0m07:51:27.793263 [debug] [MainThread]: Using duckdb connection "master"
[0m07:51:27.794267 [debug] [MainThread]: On master: BEGIN
[0m07:51:27.795295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:51:27.796965 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:51:27.797964 [debug] [MainThread]: On master: COMMIT
[0m07:51:27.797964 [debug] [MainThread]: Using duckdb connection "master"
[0m07:51:27.799603 [debug] [MainThread]: On master: COMMIT
[0m07:51:27.800591 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:51:27.801621 [debug] [MainThread]: On master: Close
[0m07:51:27.819866 [debug] [Thread-1 (]: Began running node seed.personal_finance_tracker.raw_bank_transactions
[0m07:51:27.821853 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_bank_transactions .............................. [RUN]
[0m07:51:27.824045 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.personal_finance_tracker.raw_bank_transactions'
[0m07:51:27.824045 [debug] [Thread-1 (]: Began compiling node seed.personal_finance_tracker.raw_bank_transactions
[0m07:51:27.826029 [debug] [Thread-1 (]: Began executing node seed.personal_finance_tracker.raw_bank_transactions
[0m07:51:28.061441 [debug] [Thread-1 (]: Using duckdb connection "seed.personal_finance_tracker.raw_bank_transactions"
[0m07:51:28.061441 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: BEGIN
[0m07:51:28.062475 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:51:28.064432 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m07:51:28.065430 [debug] [Thread-1 (]: Using duckdb connection "seed.personal_finance_tracker.raw_bank_transactions"
[0m07:51:28.066427 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "seed.personal_finance_tracker.raw_bank_transactions"} */

    create table "personal_finance"."main"."raw_bank_transactions" (txn_id integer,date date,description text,amount float8,account_type text)
  
[0m07:51:28.068420 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:51:28.090374 [debug] [Thread-1 (]: Using duckdb connection "seed.personal_finance_tracker.raw_bank_transactions"
[0m07:51:28.091393 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: 
          COPY "personal_finance"."main"."raw_bank_transactions" FROM 'C:\kev\personal_finance_tracker\personal_finance_tracker\seeds\raw_bank_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m07:51:28.136483 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m07:51:28.145458 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.personal_finance_tracker.raw_bank_transactions"
[0m07:51:28.175880 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: COMMIT
[0m07:51:28.176841 [debug] [Thread-1 (]: Using duckdb connection "seed.personal_finance_tracker.raw_bank_transactions"
[0m07:51:28.176841 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: COMMIT
[0m07:51:28.189638 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m07:51:28.192630 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: Close
[0m07:51:28.196166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20a00ab9-5df8-4f13-9cea-b62849654f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B031FB6F50>]}
[0m07:51:28.197167 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.raw_bank_transactions .......................... [[32mINSERT 2500[0m in 0.37s]
[0m07:51:28.199281 [debug] [Thread-1 (]: Finished running node seed.personal_finance_tracker.raw_bank_transactions
[0m07:51:28.201154 [debug] [MainThread]: Using duckdb connection "master"
[0m07:51:28.202150 [debug] [MainThread]: On master: BEGIN
[0m07:51:28.203148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:51:28.204429 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:51:28.205466 [debug] [MainThread]: On master: COMMIT
[0m07:51:28.206463 [debug] [MainThread]: Using duckdb connection "master"
[0m07:51:28.207423 [debug] [MainThread]: On master: COMMIT
[0m07:51:28.209423 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m07:51:28.210413 [debug] [MainThread]: On master: Close
[0m07:51:28.211410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:51:28.212408 [debug] [MainThread]: Connection 'create_personal_finance_main' was properly closed.
[0m07:51:28.213407 [debug] [MainThread]: Connection 'list_personal_finance_main' was properly closed.
[0m07:51:28.214404 [debug] [MainThread]: Connection 'seed.personal_finance_tracker.raw_bank_transactions' was properly closed.
[0m07:51:28.216402 [info ] [MainThread]: 
[0m07:51:28.217396 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m07:51:28.220389 [debug] [MainThread]: Command end result
[0m07:51:28.270884 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m07:51:28.274874 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m07:51:28.286511 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\personal_finance_tracker\personal_finance_tracker\target\run_results.json
[0m07:51:28.287548 [info ] [MainThread]: 
[0m07:51:28.288507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:51:28.290501 [info ] [MainThread]: 
[0m07:51:28.291499 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m07:51:28.293601 [debug] [MainThread]: Command `dbt seed` succeeded at 07:51:28.292600 after 9.66 seconds
[0m07:51:28.293601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B030523290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B030523390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0295AD010>]}
[0m07:51:28.294601 [debug] [MainThread]: Flushing usage events
[0m07:51:29.319350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:52:10.376413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C1F3E35D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C1F4001D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C1F400E90>]}


============================== 07:52:10.382395 | 480ebd7e-15b7-4278-8b84-d85120ffe354 ==============================
[0m07:52:10.382395 [info ] [MainThread]: Running with dbt=1.11.2
[0m07:52:10.384357 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\personal_finance_tracker\\personal_finance_tracker\\logs'}
[0m07:52:10.831472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '480ebd7e-15b7-4278-8b84-d85120ffe354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C1BC27CD0>]}
[0m07:52:10.957707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '480ebd7e-15b7-4278-8b84-d85120ffe354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C1BC40110>]}
[0m07:52:10.962404 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m07:52:11.495334 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m07:52:11.752130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:52:11.753127 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m07:52:11.755122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:52:11.773699 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.personal_finance_tracker.marts
- models.personal_finance_tracker.staging
[0m07:52:11.828436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '480ebd7e-15b7-4278-8b84-d85120ffe354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C20950D90>]}
[0m07:52:11.964193 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m07:52:11.969188 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m07:52:12.025032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '480ebd7e-15b7-4278-8b84-d85120ffe354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C20885A10>]}
[0m07:52:12.026028 [info ] [MainThread]: Found 1 seed, 472 macros
[0m07:52:12.028022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '480ebd7e-15b7-4278-8b84-d85120ffe354', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C1C317710>]}
[0m07:52:12.034006 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:52:12.039991 [debug] [MainThread]: Command end result
[0m07:52:12.099159 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m07:52:12.103261 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m07:52:12.111355 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\personal_finance_tracker\personal_finance_tracker\target\run_results.json
[0m07:52:12.114347 [debug] [MainThread]: Command `dbt run` succeeded at 07:52:12.113350 after 1.88 seconds
[0m07:52:12.115343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C1F18D250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C1F3E33D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C1F3E3190>]}
[0m07:52:12.116347 [debug] [MainThread]: Flushing usage events
[0m07:52:13.033924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:01:52.718847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F480DE6C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F480DE6B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F480DE6790>]}


============================== 08:01:52.727793 | d497e724-8897-45be-a20d-e2665f0b1c9b ==============================
[0m08:01:52.727793 [info ] [MainThread]: Running with dbt=1.11.2
[0m08:01:52.729785 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt seed', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\personal_finance_tracker\\personal_finance_tracker\\logs'}
[0m08:01:53.394858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd497e724-8897-45be-a20d-e2665f0b1c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F480E393D0>]}
[0m08:01:53.516852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd497e724-8897-45be-a20d-e2665f0b1c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FFD44710>]}
[0m08:01:53.520895 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:01:53.929957 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m08:01:54.124823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:01:54.125822 [debug] [MainThread]: Partial parsing: added file: personal_finance_tracker://models\staging\stg_transactions.sql
[0m08:01:54.567096 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.personal_finance_tracker.marts
[0m08:01:54.577222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd497e724-8897-45be-a20d-e2665f0b1c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F482263B50>]}
[0m08:01:54.689938 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:01:54.701227 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:01:54.807741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd497e724-8897-45be-a20d-e2665f0b1c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4824108D0>]}
[0m08:01:54.808740 [info ] [MainThread]: Found 1 seed, 1 model, 472 macros
[0m08:01:54.809734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd497e724-8897-45be-a20d-e2665f0b1c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48064CD10>]}
[0m08:01:54.813539 [info ] [MainThread]: 
[0m08:01:54.814505 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:01:54.816502 [info ] [MainThread]: 
[0m08:01:54.818497 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:01:54.823482 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance'
[0m08:01:55.000684 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance"
[0m08:01:55.001682 [debug] [ThreadPool]: On list_personal_finance: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"personal_finance"'
    
  
  
[0m08:01:55.002679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:55.071525 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m08:01:55.073520 [debug] [ThreadPool]: On list_personal_finance: Close
[0m08:01:55.075387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_personal_finance, now create_personal_finance_main)
[0m08:01:55.076389 [debug] [ThreadPool]: Creating schema "database: "personal_finance"
schema: "main"
"
[0m08:01:55.087528 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:01:55.088488 [debug] [ThreadPool]: On create_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "create_personal_finance_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='personal_finance'
        and type='sqlite'
    
  
[0m08:01:55.088488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:01:55.091479 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:01:55.093474 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:01:55.094471 [debug] [ThreadPool]: On create_personal_finance_main: BEGIN
[0m08:01:55.095469 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:01:55.096466 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:01:55.097464 [debug] [ThreadPool]: On create_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "create_personal_finance_main"} */

    
    
        create schema if not exists "personal_finance"."main"
    
[0m08:01:55.100583 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:01:55.101584 [debug] [ThreadPool]: On create_personal_finance_main: COMMIT
[0m08:01:55.102702 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:01:55.103702 [debug] [ThreadPool]: On create_personal_finance_main: COMMIT
[0m08:01:55.104701 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:01:55.105735 [debug] [ThreadPool]: On create_personal_finance_main: Close
[0m08:01:55.113675 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance_main'
[0m08:01:55.121653 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:01:55.122689 [debug] [ThreadPool]: On list_personal_finance_main: BEGIN
[0m08:01:55.123649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:55.125282 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:01:55.126269 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:01:55.126269 [debug] [ThreadPool]: On list_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance_main"} */
select
      'personal_finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'personal_finance'
  
[0m08:01:55.163364 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m08:01:55.166395 [debug] [ThreadPool]: On list_personal_finance_main: ROLLBACK
[0m08:01:55.167878 [debug] [ThreadPool]: Failed to rollback 'list_personal_finance_main'
[0m08:01:55.168878 [debug] [ThreadPool]: On list_personal_finance_main: Close
[0m08:01:55.169875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd497e724-8897-45be-a20d-e2665f0b1c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48064CE90>]}
[0m08:01:55.171872 [debug] [MainThread]: Using duckdb connection "master"
[0m08:01:55.172905 [debug] [MainThread]: On master: BEGIN
[0m08:01:55.172905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:01:55.175017 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:01:55.176016 [debug] [MainThread]: On master: COMMIT
[0m08:01:55.177015 [debug] [MainThread]: Using duckdb connection "master"
[0m08:01:55.178012 [debug] [MainThread]: On master: COMMIT
[0m08:01:55.179120 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:01:55.179640 [debug] [MainThread]: On master: Close
[0m08:01:55.187921 [debug] [Thread-1 (]: Began running node seed.personal_finance_tracker.raw_bank_transactions
[0m08:01:55.188921 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_bank_transactions .............................. [RUN]
[0m08:01:55.190915 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.personal_finance_tracker.raw_bank_transactions'
[0m08:01:55.191913 [debug] [Thread-1 (]: Began compiling node seed.personal_finance_tracker.raw_bank_transactions
[0m08:01:55.192912 [debug] [Thread-1 (]: Began executing node seed.personal_finance_tracker.raw_bank_transactions
[0m08:01:55.392881 [debug] [Thread-1 (]: Using duckdb connection "seed.personal_finance_tracker.raw_bank_transactions"
[0m08:01:55.393877 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: BEGIN
[0m08:01:55.393877 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:01:55.395838 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:01:55.396833 [debug] [Thread-1 (]: Using duckdb connection "seed.personal_finance_tracker.raw_bank_transactions"
[0m08:01:55.397831 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "seed.personal_finance_tracker.raw_bank_transactions"} */
truncate table "personal_finance"."main"."raw_bank_transactions"
[0m08:01:55.405204 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:01:55.419168 [debug] [Thread-1 (]: Using duckdb connection "seed.personal_finance_tracker.raw_bank_transactions"
[0m08:01:55.420166 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: 
          COPY "personal_finance"."main"."raw_bank_transactions" FROM 'C:\kev\personal_finance_tracker\personal_finance_tracker\seeds\raw_bank_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m08:01:55.485429 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m08:01:55.494404 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.personal_finance_tracker.raw_bank_transactions"
[0m08:01:55.509629 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: COMMIT
[0m08:01:55.510629 [debug] [Thread-1 (]: Using duckdb connection "seed.personal_finance_tracker.raw_bank_transactions"
[0m08:01:55.511625 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: COMMIT
[0m08:01:55.521599 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:01:55.524713 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: Close
[0m08:01:55.530003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd497e724-8897-45be-a20d-e2665f0b1c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F48295CC90>]}
[0m08:01:55.531000 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.raw_bank_transactions .......................... [[32mINSERT 2500[0m in 0.34s]
[0m08:01:55.532997 [debug] [Thread-1 (]: Finished running node seed.personal_finance_tracker.raw_bank_transactions
[0m08:01:55.534991 [debug] [MainThread]: Using duckdb connection "master"
[0m08:01:55.535989 [debug] [MainThread]: On master: BEGIN
[0m08:01:55.536986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:01:55.537989 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:01:55.538980 [debug] [MainThread]: On master: COMMIT
[0m08:01:55.539978 [debug] [MainThread]: Using duckdb connection "master"
[0m08:01:55.540976 [debug] [MainThread]: On master: COMMIT
[0m08:01:55.541970 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:01:55.542968 [debug] [MainThread]: On master: Close
[0m08:01:55.543964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:01:55.544963 [debug] [MainThread]: Connection 'create_personal_finance_main' was properly closed.
[0m08:01:55.545962 [debug] [MainThread]: Connection 'list_personal_finance_main' was properly closed.
[0m08:01:55.545962 [debug] [MainThread]: Connection 'seed.personal_finance_tracker.raw_bank_transactions' was properly closed.
[0m08:01:55.547954 [info ] [MainThread]: 
[0m08:01:55.548952 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m08:01:55.552118 [debug] [MainThread]: Command end result
[0m08:01:55.596476 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:01:55.600430 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:01:55.611401 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\personal_finance_tracker\personal_finance_tracker\target\run_results.json
[0m08:01:55.612398 [info ] [MainThread]: 
[0m08:01:55.613396 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:01:55.615393 [info ] [MainThread]: 
[0m08:01:55.616390 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m08:01:55.618385 [debug] [MainThread]: Command `dbt seed` succeeded at 08:01:55.618385 after 3.05 seconds
[0m08:01:55.620401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F480A7EA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4FFE8DA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4F9DBD010>]}
[0m08:01:55.621411 [debug] [MainThread]: Flushing usage events
[0m08:01:56.581301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:02:03.414538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D0050490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D0050610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D0052BD0>]}


============================== 08:02:03.419525 | abaec18b-192e-4534-b734-3b3834b9ba0f ==============================
[0m08:02:03.419525 [info ] [MainThread]: Running with dbt=1.11.2
[0m08:02:03.421521 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\personal_finance_tracker\\personal_finance_tracker\\logs'}
[0m08:02:03.807851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abaec18b-192e-4534-b734-3b3834b9ba0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D00AA3D0>]}
[0m08:02:03.908903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abaec18b-192e-4534-b734-3b3834b9ba0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231CC890150>]}
[0m08:02:03.913888 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:02:04.309678 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m08:02:04.552197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:02:04.552951 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m08:02:04.553959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:02:04.564236 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.personal_finance_tracker.marts
[0m08:02:04.623798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abaec18b-192e-4534-b734-3b3834b9ba0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D15A0690>]}
[0m08:02:04.752844 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:02:04.752844 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:02:04.806131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abaec18b-192e-4534-b734-3b3834b9ba0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D16AC1D0>]}
[0m08:02:04.807131 [info ] [MainThread]: Found 1 seed, 1 model, 472 macros
[0m08:02:04.808130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abaec18b-192e-4534-b734-3b3834b9ba0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231CFEE56D0>]}
[0m08:02:04.811117 [info ] [MainThread]: 
[0m08:02:04.813113 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:02:04.814112 [info ] [MainThread]: 
[0m08:02:04.816106 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:02:04.819098 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance'
[0m08:02:04.956760 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance"
[0m08:02:04.956760 [debug] [ThreadPool]: On list_personal_finance: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"personal_finance"'
    
  
  
[0m08:02:04.957717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:04.994964 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m08:02:04.996958 [debug] [ThreadPool]: On list_personal_finance: Close
[0m08:02:04.998952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_personal_finance, now create_personal_finance_main)
[0m08:02:04.998952 [debug] [ThreadPool]: Creating schema "database: "personal_finance"
schema: "main"
"
[0m08:02:05.010180 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:02:05.011164 [debug] [ThreadPool]: On create_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "create_personal_finance_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='personal_finance'
        and type='sqlite'
    
  
[0m08:02:05.012197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:02:05.014156 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:02:05.016184 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:02:05.017183 [debug] [ThreadPool]: On create_personal_finance_main: BEGIN
[0m08:02:05.018182 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:02:05.019143 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:02:05.020177 [debug] [ThreadPool]: On create_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "create_personal_finance_main"} */

    
    
        create schema if not exists "personal_finance"."main"
    
[0m08:02:05.021138 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:02:05.023132 [debug] [ThreadPool]: On create_personal_finance_main: COMMIT
[0m08:02:05.024162 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:02:05.025135 [debug] [ThreadPool]: On create_personal_finance_main: COMMIT
[0m08:02:05.026160 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:02:05.027161 [debug] [ThreadPool]: On create_personal_finance_main: Close
[0m08:02:05.036096 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance_main'
[0m08:02:05.045110 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:02:05.046106 [debug] [ThreadPool]: On list_personal_finance_main: BEGIN
[0m08:02:05.046106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:05.048067 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:02:05.049062 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:02:05.049062 [debug] [ThreadPool]: On list_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance_main"} */
select
      'personal_finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'personal_finance'
  
[0m08:02:05.073993 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m08:02:05.077127 [debug] [ThreadPool]: On list_personal_finance_main: ROLLBACK
[0m08:02:05.078090 [debug] [ThreadPool]: Failed to rollback 'list_personal_finance_main'
[0m08:02:05.079215 [debug] [ThreadPool]: On list_personal_finance_main: Close
[0m08:02:05.080759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abaec18b-192e-4534-b734-3b3834b9ba0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D0112190>]}
[0m08:02:05.081757 [debug] [MainThread]: Using duckdb connection "master"
[0m08:02:05.082798 [debug] [MainThread]: On master: BEGIN
[0m08:02:05.083752 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:02:05.084749 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:02:05.085785 [debug] [MainThread]: On master: COMMIT
[0m08:02:05.086779 [debug] [MainThread]: Using duckdb connection "master"
[0m08:02:05.087832 [debug] [MainThread]: On master: COMMIT
[0m08:02:05.088738 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:02:05.089772 [debug] [MainThread]: On master: Close
[0m08:02:05.095719 [debug] [Thread-1 (]: Began running node model.personal_finance_tracker.stg_transactions
[0m08:02:05.096716 [info ] [Thread-1 (]: 1 of 1 START sql view model main.stg_transactions .............................. [RUN]
[0m08:02:05.098713 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.personal_finance_tracker.stg_transactions'
[0m08:02:05.099840 [debug] [Thread-1 (]: Began compiling node model.personal_finance_tracker.stg_transactions
[0m08:02:05.167639 [debug] [Thread-1 (]: Writing injected SQL for node "model.personal_finance_tracker.stg_transactions"
[0m08:02:05.171630 [debug] [Thread-1 (]: Began executing node model.personal_finance_tracker.stg_transactions
[0m08:02:05.222894 [debug] [Thread-1 (]: Writing runtime sql for node "model.personal_finance_tracker.stg_transactions"
[0m08:02:05.224960 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:02:05.225960 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: BEGIN
[0m08:02:05.226956 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:02:05.229758 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:02:05.230746 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:02:05.232742 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.stg_transactions"} */

  
  create view "personal_finance"."main"."stg_transactions__dbt_tmp" as (
    -- Staging layer: Clean and standardize raw transaction data
-- Focus: Unify merchant names (Starbucks/Dunkin variants)

with source_data as (
    select * from "personal_finance"."main"."raw_bank_transactions"
),

cleaned as (
    select
        txn_id,
        date::date as transaction_date,
        
        -- Unify merchant names using CASE logic
        case
            when upper(description) like '%STARBUCKS%' then 'Starbucks'
            when upper(description) like '%DUNKIN%' then 'Dunkin'
            when upper(description) like '%NETFLIX%' then 'Netflix'
            when upper(description) like '%AMAZON%' then 'Amazon'
            when upper(description) like '%WALMART%' then 'Walmart'
            when upper(description) like '%RENT%' then 'Rent'
            when upper(description) like '%SALARY%' then 'Salary'
            else description
        end as merchant_clean,
        
        description as original_description,
        amount,
        account_type,
        
        -- Add metadata
        current_timestamp as loaded_at
    from source_data
)

select * from cleaned
  );

[0m08:02:05.243559 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m08:02:05.254860 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:02:05.255855 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.stg_transactions"} */
alter view "personal_finance"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m08:02:05.257815 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:02:05.275802 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: COMMIT
[0m08:02:05.276802 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:02:05.277762 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: COMMIT
[0m08:02:05.283161 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:02:05.294170 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:02:05.295169 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.stg_transactions"} */

      drop view if exists "personal_finance"."main"."stg_transactions__dbt_backup" cascade
    
[0m08:02:05.297127 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:02:05.300787 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: Close
[0m08:02:05.303907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abaec18b-192e-4534-b734-3b3834b9ba0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231D1220190>]}
[0m08:02:05.304944 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.20s]
[0m08:02:05.306902 [debug] [Thread-1 (]: Finished running node model.personal_finance_tracker.stg_transactions
[0m08:02:05.309929 [debug] [MainThread]: Using duckdb connection "master"
[0m08:02:05.309929 [debug] [MainThread]: On master: BEGIN
[0m08:02:05.310891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:02:05.312886 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:02:05.312886 [debug] [MainThread]: On master: COMMIT
[0m08:02:05.313924 [debug] [MainThread]: Using duckdb connection "master"
[0m08:02:05.314880 [debug] [MainThread]: On master: COMMIT
[0m08:02:05.315904 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:02:05.316912 [debug] [MainThread]: On master: Close
[0m08:02:05.317872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:02:05.318905 [debug] [MainThread]: Connection 'create_personal_finance_main' was properly closed.
[0m08:02:05.318905 [debug] [MainThread]: Connection 'list_personal_finance_main' was properly closed.
[0m08:02:05.319866 [debug] [MainThread]: Connection 'model.personal_finance_tracker.stg_transactions' was properly closed.
[0m08:02:05.320864 [info ] [MainThread]: 
[0m08:02:05.321861 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m08:02:05.324855 [debug] [MainThread]: Command end result
[0m08:02:05.382987 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:02:05.387948 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:02:05.401905 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\personal_finance_tracker\personal_finance_tracker\target\run_results.json
[0m08:02:05.402932 [info ] [MainThread]: 
[0m08:02:05.404891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:02:05.405893 [info ] [MainThread]: 
[0m08:02:05.407890 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m08:02:05.409877 [debug] [MainThread]: Command `dbt run` succeeded at 08:02:05.409877 after 2.11 seconds
[0m08:02:05.410874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C913D010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C9369B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231C936A110>]}
[0m08:02:05.411872 [debug] [MainThread]: Flushing usage events
[0m08:02:06.340780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:05:05.657851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B03736990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B03734950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B037368D0>]}


============================== 08:05:05.667000 | 99dc206e-8176-4499-bf3d-138b02820fa5 ==============================
[0m08:05:05.667000 [info ] [MainThread]: Running with dbt=1.11.2
[0m08:05:05.668995 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt seed', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\personal_finance_tracker\\personal_finance_tracker\\logs'}
[0m08:05:06.305135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99dc206e-8176-4499-bf3d-138b02820fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B03737CD0>]}
[0m08:05:06.466622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99dc206e-8176-4499-bf3d-138b02820fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B7FF70A90>]}
[0m08:05:06.477451 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:05:06.986174 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m08:05:07.352185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m08:05:07.353182 [debug] [MainThread]: Partial parsing: added file: personal_finance_tracker://models\marts\fct_burn_rate.sql
[0m08:05:07.354180 [debug] [MainThread]: Partial parsing: updated file: personal_finance_tracker://models\staging\stg_transactions.sql
[0m08:05:07.951754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99dc206e-8176-4499-bf3d-138b02820fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B04E5AB10>]}
[0m08:05:08.139774 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:05:08.150771 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:05:08.415548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99dc206e-8176-4499-bf3d-138b02820fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B04960210>]}
[0m08:05:08.417543 [info ] [MainThread]: Found 1 seed, 2 models, 472 macros
[0m08:05:08.420536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99dc206e-8176-4499-bf3d-138b02820fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B049AF210>]}
[0m08:05:08.425523 [info ] [MainThread]: 
[0m08:05:08.452702 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:05:08.455042 [info ] [MainThread]: 
[0m08:05:08.457038 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:05:08.461026 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance'
[0m08:05:08.676772 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance"
[0m08:05:08.677771 [debug] [ThreadPool]: On list_personal_finance: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"personal_finance"'
    
  
  
[0m08:05:08.678769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:08.763765 [debug] [ThreadPool]: SQL status: OK in 0.086 seconds
[0m08:05:08.767756 [debug] [ThreadPool]: On list_personal_finance: Close
[0m08:05:08.768752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_personal_finance, now create_personal_finance_main)
[0m08:05:08.769750 [debug] [ThreadPool]: Creating schema "database: "personal_finance"
schema: "main"
"
[0m08:05:08.781718 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:05:08.782718 [debug] [ThreadPool]: On create_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "create_personal_finance_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='personal_finance'
        and type='sqlite'
    
  
[0m08:05:08.783714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:05:08.785633 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:05:08.788628 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:05:08.789625 [debug] [ThreadPool]: On create_personal_finance_main: BEGIN
[0m08:05:08.790624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:05:08.791620 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:05:08.792619 [debug] [ThreadPool]: On create_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "create_personal_finance_main"} */

    
    
        create schema if not exists "personal_finance"."main"
    
[0m08:05:08.795769 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:05:08.797766 [debug] [ThreadPool]: On create_personal_finance_main: COMMIT
[0m08:05:08.797766 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:05:08.798763 [debug] [ThreadPool]: On create_personal_finance_main: COMMIT
[0m08:05:08.800759 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:05:08.800759 [debug] [ThreadPool]: On create_personal_finance_main: Close
[0m08:05:08.810378 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance_main'
[0m08:05:08.821356 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:05:08.821356 [debug] [ThreadPool]: On list_personal_finance_main: BEGIN
[0m08:05:08.822351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:08.824444 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:05:08.824444 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:05:08.825444 [debug] [ThreadPool]: On list_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance_main"} */
select
      'personal_finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'personal_finance'
  
[0m08:05:08.867751 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m08:05:08.870781 [debug] [ThreadPool]: On list_personal_finance_main: ROLLBACK
[0m08:05:08.872738 [debug] [ThreadPool]: Failed to rollback 'list_personal_finance_main'
[0m08:05:08.873735 [debug] [ThreadPool]: On list_personal_finance_main: Close
[0m08:05:08.875729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99dc206e-8176-4499-bf3d-138b02820fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B04960390>]}
[0m08:05:08.876727 [debug] [MainThread]: Using duckdb connection "master"
[0m08:05:08.877760 [debug] [MainThread]: On master: BEGIN
[0m08:05:08.878723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:05:08.879754 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:05:08.880716 [debug] [MainThread]: On master: COMMIT
[0m08:05:08.881718 [debug] [MainThread]: Using duckdb connection "master"
[0m08:05:08.882749 [debug] [MainThread]: On master: COMMIT
[0m08:05:08.884706 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:05:08.884706 [debug] [MainThread]: On master: Close
[0m08:05:08.893380 [debug] [Thread-1 (]: Began running node seed.personal_finance_tracker.raw_bank_transactions
[0m08:05:08.894378 [info ] [Thread-1 (]: 1 of 1 START seed file main.raw_bank_transactions .............................. [RUN]
[0m08:05:08.896373 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.personal_finance_tracker.raw_bank_transactions'
[0m08:05:08.897376 [debug] [Thread-1 (]: Began compiling node seed.personal_finance_tracker.raw_bank_transactions
[0m08:05:08.898368 [debug] [Thread-1 (]: Began executing node seed.personal_finance_tracker.raw_bank_transactions
[0m08:05:09.113545 [debug] [Thread-1 (]: Using duckdb connection "seed.personal_finance_tracker.raw_bank_transactions"
[0m08:05:09.114545 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: BEGIN
[0m08:05:09.115505 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:05:09.116539 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:05:09.117538 [debug] [Thread-1 (]: Using duckdb connection "seed.personal_finance_tracker.raw_bank_transactions"
[0m08:05:09.119534 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "seed.personal_finance_tracker.raw_bank_transactions"} */
truncate table "personal_finance"."main"."raw_bank_transactions"
[0m08:05:09.131677 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m08:05:09.148633 [debug] [Thread-1 (]: Using duckdb connection "seed.personal_finance_tracker.raw_bank_transactions"
[0m08:05:09.150794 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: 
          COPY "personal_finance"."main"."raw_bank_transactions" FROM 'C:\kev\personal_finance_tracker\personal_finance_tracker\seeds\raw_bank_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m08:05:09.215772 [debug] [Thread-1 (]: SQL status: OK in 0.064 seconds
[0m08:05:09.225897 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.personal_finance_tracker.raw_bank_transactions"
[0m08:05:09.243850 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: COMMIT
[0m08:05:09.244847 [debug] [Thread-1 (]: Using duckdb connection "seed.personal_finance_tracker.raw_bank_transactions"
[0m08:05:09.245881 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: COMMIT
[0m08:05:09.255172 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m08:05:09.259163 [debug] [Thread-1 (]: On seed.personal_finance_tracker.raw_bank_transactions: Close
[0m08:05:09.262609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99dc206e-8176-4499-bf3d-138b02820fa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B04E71550>]}
[0m08:05:09.263647 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.raw_bank_transactions .......................... [[32mINSERT 2500[0m in 0.36s]
[0m08:05:09.265612 [debug] [Thread-1 (]: Finished running node seed.personal_finance_tracker.raw_bank_transactions
[0m08:05:09.268632 [debug] [MainThread]: Using duckdb connection "master"
[0m08:05:09.269595 [debug] [MainThread]: On master: BEGIN
[0m08:05:09.270595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:05:09.271590 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m08:05:09.272595 [debug] [MainThread]: On master: COMMIT
[0m08:05:09.273622 [debug] [MainThread]: Using duckdb connection "master"
[0m08:05:09.274730 [debug] [MainThread]: On master: COMMIT
[0m08:05:09.276728 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:05:09.277724 [debug] [MainThread]: On master: Close
[0m08:05:09.279718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:05:09.280716 [debug] [MainThread]: Connection 'create_personal_finance_main' was properly closed.
[0m08:05:09.281713 [debug] [MainThread]: Connection 'list_personal_finance_main' was properly closed.
[0m08:05:09.282710 [debug] [MainThread]: Connection 'seed.personal_finance_tracker.raw_bank_transactions' was properly closed.
[0m08:05:09.286707 [info ] [MainThread]: 
[0m08:05:09.287524 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m08:05:09.290522 [debug] [MainThread]: Command end result
[0m08:05:09.342352 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:05:09.348337 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:05:09.364310 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\personal_finance_tracker\personal_finance_tracker\target\run_results.json
[0m08:05:09.366290 [info ] [MainThread]: 
[0m08:05:09.368283 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:05:09.369284 [info ] [MainThread]: 
[0m08:05:09.371276 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m08:05:09.374642 [debug] [MainThread]: Command `dbt seed` succeeded at 08:05:09.373613 after 3.88 seconds
[0m08:05:09.375636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B034BD710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B037343D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B7C7FD010>]}
[0m08:05:09.376597 [debug] [MainThread]: Flushing usage events
[0m08:05:10.347436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:05:45.378461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CAFFB2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CAFF935D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CAFFB1D90>]}


============================== 08:05:45.385266 | ffdbd942-41d5-47c2-aba9-90838f08c948 ==============================
[0m08:05:45.385266 [info ] [MainThread]: Running with dbt=1.11.2
[0m08:05:45.387248 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\personal_finance_tracker\\personal_finance_tracker\\logs'}
[0m08:05:45.800028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffdbd942-41d5-47c2-aba9-90838f08c948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB0056A90>]}
[0m08:05:45.939701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffdbd942-41d5-47c2-aba9-90838f08c948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CAC7F0310>]}
[0m08:05:45.944689 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:05:46.395723 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m08:05:46.706420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:05:46.707417 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m08:05:46.708424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:05:46.779853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffdbd942-41d5-47c2-aba9-90838f08c948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB154AF50>]}
[0m08:05:46.929838 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:05:46.936819 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:05:46.983827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffdbd942-41d5-47c2-aba9-90838f08c948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB1487690>]}
[0m08:05:46.985822 [info ] [MainThread]: Found 1 seed, 2 models, 472 macros
[0m08:05:46.988814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffdbd942-41d5-47c2-aba9-90838f08c948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB143EED0>]}
[0m08:05:46.991807 [info ] [MainThread]: 
[0m08:05:46.992803 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:05:46.994799 [info ] [MainThread]: 
[0m08:05:46.995796 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:05:47.011184 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance'
[0m08:05:47.189318 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance"
[0m08:05:47.190315 [debug] [ThreadPool]: On list_personal_finance: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"personal_finance"'
    
  
  
[0m08:05:47.191313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:47.234534 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m08:05:47.238522 [debug] [ThreadPool]: On list_personal_finance: Close
[0m08:05:47.239519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_personal_finance, now create_personal_finance_main)
[0m08:05:47.241515 [debug] [ThreadPool]: Creating schema "database: "personal_finance"
schema: "main"
"
[0m08:05:47.254955 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:05:47.255951 [debug] [ThreadPool]: On create_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "create_personal_finance_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='personal_finance'
        and type='sqlite'
    
  
[0m08:05:47.256948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:05:47.258943 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:05:47.260938 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:05:47.261942 [debug] [ThreadPool]: On create_personal_finance_main: BEGIN
[0m08:05:47.262932 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:05:47.263930 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:05:47.266922 [debug] [ThreadPool]: On create_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "create_personal_finance_main"} */

    
    
        create schema if not exists "personal_finance"."main"
    
[0m08:05:47.268918 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:05:47.271910 [debug] [ThreadPool]: On create_personal_finance_main: COMMIT
[0m08:05:47.272907 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:05:47.275012 [debug] [ThreadPool]: On create_personal_finance_main: COMMIT
[0m08:05:47.276011 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:05:47.277009 [debug] [ThreadPool]: On create_personal_finance_main: Close
[0m08:05:47.279986 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance_main'
[0m08:05:47.291946 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:05:47.292945 [debug] [ThreadPool]: On list_personal_finance_main: BEGIN
[0m08:05:47.293942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:05:47.295936 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:05:47.295936 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:05:47.296933 [debug] [ThreadPool]: On list_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance_main"} */
select
      'personal_finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'personal_finance'
  
[0m08:05:47.330842 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m08:05:47.333835 [debug] [ThreadPool]: On list_personal_finance_main: ROLLBACK
[0m08:05:47.334833 [debug] [ThreadPool]: Failed to rollback 'list_personal_finance_main'
[0m08:05:47.335831 [debug] [ThreadPool]: On list_personal_finance_main: Close
[0m08:05:47.337823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffdbd942-41d5-47c2-aba9-90838f08c948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB0072D10>]}
[0m08:05:47.338823 [debug] [MainThread]: Using duckdb connection "master"
[0m08:05:47.339819 [debug] [MainThread]: On master: BEGIN
[0m08:05:47.340818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:05:47.341813 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:05:47.342811 [debug] [MainThread]: On master: COMMIT
[0m08:05:47.343808 [debug] [MainThread]: Using duckdb connection "master"
[0m08:05:47.344805 [debug] [MainThread]: On master: COMMIT
[0m08:05:47.345802 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:05:47.346800 [debug] [MainThread]: On master: Close
[0m08:05:47.354113 [debug] [Thread-1 (]: Began running node model.personal_finance_tracker.stg_transactions
[0m08:05:47.355111 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m08:05:47.357107 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.personal_finance_tracker.stg_transactions'
[0m08:05:47.358105 [debug] [Thread-1 (]: Began compiling node model.personal_finance_tracker.stg_transactions
[0m08:05:47.430909 [debug] [Thread-1 (]: Writing injected SQL for node "model.personal_finance_tracker.stg_transactions"
[0m08:05:47.433912 [debug] [Thread-1 (]: Began executing node model.personal_finance_tracker.stg_transactions
[0m08:05:47.481596 [debug] [Thread-1 (]: Writing runtime sql for node "model.personal_finance_tracker.stg_transactions"
[0m08:05:47.484589 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:05:47.485588 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: BEGIN
[0m08:05:47.486583 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:05:47.487581 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:05:47.488578 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:05:47.490574 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.stg_transactions"} */

  
  create view "personal_finance"."main"."stg_transactions__dbt_tmp" as (
    -- Staging layer: Clean and standardize raw transaction data

-- Focus: Unify merchant names (Starbucks/Dunkin variants)

with source_data as (
    select * from "personal_finance"."main"."raw_bank_transactions"
),

cleaned as (
    select
        txn_id,
        date::date as transaction_date,
        
        -- Unify merchant names using CASE logic
        case
            when upper(description) like '%STARBUCKS%' then 'Starbucks'
            when upper(description) like '%DUNKIN%' then 'Dunkin'
            when upper(description) like '%NETFLIX%' then 'Netflix'
            when upper(description) like '%AMAZON%' then 'Amazon'
            when upper(description) like '%WALMART%' then 'Walmart'
            when upper(description) like '%RENT%' then 'Rent'
            when upper(description) like '%SALARY%' then 'Salary'
            else description
        end as merchant_clean,
        
        description as original_description,
        amount,
        account_type,
        
        -- Add metadata
        current_timestamp as loaded_at
    from source_data
)

select * from cleaned
  );

[0m08:05:47.501981 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m08:05:47.514091 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:05:47.515089 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.stg_transactions"} */
alter view "personal_finance"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m08:05:47.517084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:47.522082 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:05:47.523066 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.stg_transactions"} */
alter view "personal_finance"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m08:05:47.525061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:05:47.544012 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: COMMIT
[0m08:05:47.545012 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:05:47.546006 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: COMMIT
[0m08:05:47.551932 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:05:47.562118 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:05:47.563115 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.stg_transactions"} */

      drop view if exists "personal_finance"."main"."stg_transactions__dbt_backup" cascade
    
[0m08:05:47.566350 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:05:47.569380 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: Close
[0m08:05:47.573335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffdbd942-41d5-47c2-aba9-90838f08c948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB0058210>]}
[0m08:05:47.574493 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.21s]
[0m08:05:47.576489 [debug] [Thread-1 (]: Finished running node model.personal_finance_tracker.stg_transactions
[0m08:05:47.578585 [debug] [Thread-3 (]: Began running node model.personal_finance_tracker.fct_burn_rate
[0m08:05:47.579585 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_burn_rate ................................ [RUN]
[0m08:05:47.581581 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.personal_finance_tracker.fct_burn_rate'
[0m08:05:47.583576 [debug] [Thread-3 (]: Began compiling node model.personal_finance_tracker.fct_burn_rate
[0m08:05:47.592550 [debug] [Thread-3 (]: Writing injected SQL for node "model.personal_finance_tracker.fct_burn_rate"
[0m08:05:47.594545 [debug] [Thread-3 (]: Began executing node model.personal_finance_tracker.fct_burn_rate
[0m08:05:47.702779 [debug] [Thread-3 (]: Writing runtime sql for node "model.personal_finance_tracker.fct_burn_rate"
[0m08:05:47.713751 [debug] [Thread-3 (]: Using duckdb connection "model.personal_finance_tracker.fct_burn_rate"
[0m08:05:47.725716 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: BEGIN
[0m08:05:47.727712 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:05:47.729707 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m08:05:47.733695 [debug] [Thread-3 (]: Using duckdb connection "model.personal_finance_tracker.fct_burn_rate"
[0m08:05:47.736689 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.fct_burn_rate"} */

  
    
    

    create  table
      "personal_finance"."main"."fct_burn_rate__dbt_tmp"
  
    as (
      -- Marts layer: Calculate daily burn rate with rolling averages
-- Focus: Window functions for trend analysis

with daily_spend as (
    select
        transaction_date,
        sum(amount) as daily_total,
        count(*) as transaction_count
    from "personal_finance"."main"."stg_transactions"
    group by transaction_date
),

burn_rate_calc as (
    select
        transaction_date,
        daily_total,
        transaction_count,
        
        -- 7-day rolling average (window function #1)
        avg(daily_total) over (
            order by transaction_date
            rows between 6 preceding and current row
        ) as avg_7day_spend,
        
        -- Cumulative spend (window function #2)
        sum(daily_total) over (
            order by transaction_date
            rows between unbounded preceding and current row
        ) as cumulative_spend,
        
        -- Running transaction count (window function #3)
        sum(transaction_count) over (
            order by transaction_date
            rows between unbounded preceding and current row
        ) as cumulative_transactions,
        
        -- Day-over-day change (window function #4)
        daily_total - lag(daily_total, 1) over (
            order by transaction_date
        ) as day_over_day_change,
        
        -- Percentage change from previous day (window function #5)
        round(
            ((daily_total - lag(daily_total, 1) over (order by transaction_date)) 
            / nullif(lag(daily_total, 1) over (order by transaction_date), 0)) * 100,
            2
        ) as pct_change_from_prev_day,
        
        -- Rank days by spending (window function #6)
        rank() over (order by daily_total desc) as spend_rank
        
    from daily_spend
)

select * from burn_rate_calc
order by transaction_date
    );
  
  
[0m08:05:47.774682 [debug] [Thread-3 (]: SQL status: OK in 0.033 seconds
[0m08:05:47.785659 [debug] [Thread-3 (]: Using duckdb connection "model.personal_finance_tracker.fct_burn_rate"
[0m08:05:47.787650 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.fct_burn_rate"} */
alter table "personal_finance"."main"."fct_burn_rate__dbt_tmp" rename to "fct_burn_rate"
[0m08:05:47.789644 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m08:05:47.798622 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: COMMIT
[0m08:05:47.799748 [debug] [Thread-3 (]: Using duckdb connection "model.personal_finance_tracker.fct_burn_rate"
[0m08:05:47.801747 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: COMMIT
[0m08:05:47.807728 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m08:05:47.815707 [debug] [Thread-3 (]: Using duckdb connection "model.personal_finance_tracker.fct_burn_rate"
[0m08:05:47.816707 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.fct_burn_rate"} */

      drop table if exists "personal_finance"."main"."fct_burn_rate__dbt_backup" cascade
    
[0m08:05:47.819698 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m08:05:47.822690 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: Close
[0m08:05:47.823686 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffdbd942-41d5-47c2-aba9-90838f08c948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB1AB6E90>]}
[0m08:05:47.824815 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.fct_burn_rate ........................... [[32mOK[0m in 0.24s]
[0m08:05:47.826812 [debug] [Thread-3 (]: Finished running node model.personal_finance_tracker.fct_burn_rate
[0m08:05:47.829769 [debug] [MainThread]: Using duckdb connection "master"
[0m08:05:47.830759 [debug] [MainThread]: On master: BEGIN
[0m08:05:47.831757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:05:47.833751 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m08:05:47.834747 [debug] [MainThread]: On master: COMMIT
[0m08:05:47.835746 [debug] [MainThread]: Using duckdb connection "master"
[0m08:05:47.836743 [debug] [MainThread]: On master: COMMIT
[0m08:05:47.838737 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:05:47.839734 [debug] [MainThread]: On master: Close
[0m08:05:47.841728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:05:47.842727 [debug] [MainThread]: Connection 'create_personal_finance_main' was properly closed.
[0m08:05:47.843723 [debug] [MainThread]: Connection 'list_personal_finance_main' was properly closed.
[0m08:05:47.845718 [debug] [MainThread]: Connection 'model.personal_finance_tracker.stg_transactions' was properly closed.
[0m08:05:47.846717 [debug] [MainThread]: Connection 'model.personal_finance_tracker.fct_burn_rate' was properly closed.
[0m08:05:47.847714 [info ] [MainThread]: 
[0m08:05:47.849710 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m08:05:47.855699 [debug] [MainThread]: Command end result
[0m08:05:47.913780 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:05:47.918770 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:05:47.929831 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\personal_finance_tracker\personal_finance_tracker\target\run_results.json
[0m08:05:47.930828 [info ] [MainThread]: 
[0m08:05:47.932822 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:05:47.934817 [info ] [MainThread]: 
[0m08:05:47.936812 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m08:05:47.938808 [debug] [MainThread]: Command `dbt run` succeeded at 08:05:47.938808 after 2.70 seconds
[0m08:05:47.939804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA905D010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA9289B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CA928A110>]}
[0m08:05:47.940800 [debug] [MainThread]: Flushing usage events
[0m08:05:49.048115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:17:27.231920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D03CB2DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D03CB28D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D03CB2A90>]}


============================== 08:17:27.241769 | d476112d-f231-4995-a5dd-4174224cef7f ==============================
[0m08:17:27.241769 [info ] [MainThread]: Running with dbt=1.11.2
[0m08:17:27.242768 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\personal_finance_tracker\\personal_finance_tracker\\logs'}
[0m08:17:27.904622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd476112d-f231-4995-a5dd-4174224cef7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D03D61890>]}
[0m08:17:28.005770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd476112d-f231-4995-a5dd-4174224cef7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D7FCD0A10>]}
[0m08:17:28.010889 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:17:28.426132 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m08:17:28.687615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:17:28.688613 [debug] [MainThread]: Partial parsing: added file: personal_finance_tracker://models\staging\stg_schema.yml
[0m08:17:28.971470 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'stg_transactions' in package 'personal_finance_tracker'
(models\staging\stg_schema.yml). Arguments to generic tests should be nested
under the `arguments` property.
[0m08:17:28.973683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd476112d-f231-4995-a5dd-4174224cef7f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D053A2E10>]}
[0m08:17:29.148544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd476112d-f231-4995-a5dd-4174224cef7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D053B36D0>]}
[0m08:17:29.410490 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:17:29.423445 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:17:29.475965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd476112d-f231-4995-a5dd-4174224cef7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D05355050>]}
[0m08:17:29.476963 [info ] [MainThread]: Found 1 seed, 2 models, 7 data tests, 472 macros
[0m08:17:29.478989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd476112d-f231-4995-a5dd-4174224cef7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D055006D0>]}
[0m08:17:29.482204 [info ] [MainThread]: 
[0m08:17:29.483169 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:17:29.485162 [info ] [MainThread]: 
[0m08:17:29.487155 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:17:29.500447 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance'
[0m08:17:29.641427 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance"
[0m08:17:29.642424 [debug] [ThreadPool]: On list_personal_finance: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"personal_finance"'
    
  
  
[0m08:17:29.643421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:17:29.723239 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m08:17:29.726238 [debug] [ThreadPool]: On list_personal_finance: Close
[0m08:17:29.727237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_personal_finance, now create_personal_finance_main)
[0m08:17:29.728233 [debug] [ThreadPool]: Creating schema "database: "personal_finance"
schema: "main"
"
[0m08:17:29.739206 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:17:29.740205 [debug] [ThreadPool]: On create_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "create_personal_finance_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='personal_finance'
        and type='sqlite'
    
  
[0m08:17:29.740205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:17:29.743234 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:17:29.745188 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:17:29.746185 [debug] [ThreadPool]: On create_personal_finance_main: BEGIN
[0m08:17:29.747183 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:17:29.748180 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:17:29.749177 [debug] [ThreadPool]: On create_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "create_personal_finance_main"} */

    
    
        create schema if not exists "personal_finance"."main"
    
[0m08:17:29.752335 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:17:29.754099 [debug] [ThreadPool]: On create_personal_finance_main: COMMIT
[0m08:17:29.755098 [debug] [ThreadPool]: Using duckdb connection "create_personal_finance_main"
[0m08:17:29.756096 [debug] [ThreadPool]: On create_personal_finance_main: COMMIT
[0m08:17:29.757094 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:17:29.758089 [debug] [ThreadPool]: On create_personal_finance_main: Close
[0m08:17:29.760782 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance_main'
[0m08:17:29.769799 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:17:29.770795 [debug] [ThreadPool]: On list_personal_finance_main: BEGIN
[0m08:17:29.771760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:17:29.773752 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m08:17:29.773752 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:17:29.774857 [debug] [ThreadPool]: On list_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance_main"} */
select
      'personal_finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'personal_finance'
  
[0m08:17:29.817930 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m08:17:29.819928 [debug] [ThreadPool]: On list_personal_finance_main: ROLLBACK
[0m08:17:29.822921 [debug] [ThreadPool]: Failed to rollback 'list_personal_finance_main'
[0m08:17:29.822921 [debug] [ThreadPool]: On list_personal_finance_main: Close
[0m08:17:29.826031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd476112d-f231-4995-a5dd-4174224cef7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D0548FA10>]}
[0m08:17:29.827067 [debug] [MainThread]: Using duckdb connection "master"
[0m08:17:29.828026 [debug] [MainThread]: On master: BEGIN
[0m08:17:29.828026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:17:29.830023 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:17:29.831022 [debug] [MainThread]: On master: COMMIT
[0m08:17:29.831022 [debug] [MainThread]: Using duckdb connection "master"
[0m08:17:29.832016 [debug] [MainThread]: On master: COMMIT
[0m08:17:29.834017 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:17:29.834017 [debug] [MainThread]: On master: Close
[0m08:17:29.847950 [debug] [Thread-1 (]: Began running node model.personal_finance_tracker.stg_transactions
[0m08:17:29.848952 [info ] [Thread-1 (]: 1 of 2 START sql view model main.stg_transactions .............................. [RUN]
[0m08:17:29.850947 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.personal_finance_tracker.stg_transactions'
[0m08:17:29.851943 [debug] [Thread-1 (]: Began compiling node model.personal_finance_tracker.stg_transactions
[0m08:17:29.868934 [debug] [Thread-1 (]: Writing injected SQL for node "model.personal_finance_tracker.stg_transactions"
[0m08:17:29.870894 [debug] [Thread-1 (]: Began executing node model.personal_finance_tracker.stg_transactions
[0m08:17:29.917437 [debug] [Thread-1 (]: Writing runtime sql for node "model.personal_finance_tracker.stg_transactions"
[0m08:17:29.919431 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:17:29.920430 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: BEGIN
[0m08:17:29.921426 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:17:29.923424 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:17:29.924455 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:17:29.925573 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.stg_transactions"} */

  
  create view "personal_finance"."main"."stg_transactions__dbt_tmp" as (
    -- Staging layer: Clean and standardize raw transaction data

-- Focus: Unify merchant names (Starbucks/Dunkin variants)

with source_data as (
    select * from "personal_finance"."main"."raw_bank_transactions"
),

cleaned as (
    select
        txn_id,
        date::date as transaction_date,
        
        -- Unify merchant names using CASE logic
        case
            when upper(description) like '%STARBUCKS%' then 'Starbucks'
            when upper(description) like '%DUNKIN%' then 'Dunkin'
            when upper(description) like '%NETFLIX%' then 'Netflix'
            when upper(description) like '%AMAZON%' then 'Amazon'
            when upper(description) like '%WALMART%' then 'Walmart'
            when upper(description) like '%RENT%' then 'Rent'
            when upper(description) like '%SALARY%' then 'Salary'
            else description
        end as merchant_clean,
        
        description as original_description,
        amount,
        account_type,
        
        -- Add metadata
        current_timestamp as loaded_at
    from source_data
)

select * from cleaned
  );

[0m08:17:29.930417 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m08:17:29.951509 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:17:29.952508 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.stg_transactions"} */
alter view "personal_finance"."main"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m08:17:29.953690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:17:29.959675 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:17:29.960674 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.stg_transactions"} */
alter view "personal_finance"."main"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m08:17:29.962667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:17:29.984956 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: COMMIT
[0m08:17:29.985951 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:17:29.986927 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: COMMIT
[0m08:17:29.992899 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:17:30.005866 [debug] [Thread-1 (]: Using duckdb connection "model.personal_finance_tracker.stg_transactions"
[0m08:17:30.006864 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.stg_transactions"} */

      drop view if exists "personal_finance"."main"."stg_transactions__dbt_backup" cascade
    
[0m08:17:30.009854 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:17:30.014844 [debug] [Thread-1 (]: On model.personal_finance_tracker.stg_transactions: Close
[0m08:17:30.018861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd476112d-f231-4995-a5dd-4174224cef7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D0583BF90>]}
[0m08:17:30.019898 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.stg_transactions ......................... [[32mOK[0m in 0.17s]
[0m08:17:30.021856 [debug] [Thread-1 (]: Finished running node model.personal_finance_tracker.stg_transactions
[0m08:17:30.023851 [debug] [Thread-3 (]: Began running node model.personal_finance_tracker.fct_burn_rate
[0m08:17:30.025847 [info ] [Thread-3 (]: 2 of 2 START sql table model main.fct_burn_rate ................................ [RUN]
[0m08:17:30.027893 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.personal_finance_tracker.fct_burn_rate'
[0m08:17:30.028877 [debug] [Thread-3 (]: Began compiling node model.personal_finance_tracker.fct_burn_rate
[0m08:17:30.036855 [debug] [Thread-3 (]: Writing injected SQL for node "model.personal_finance_tracker.fct_burn_rate"
[0m08:17:30.038811 [debug] [Thread-3 (]: Began executing node model.personal_finance_tracker.fct_burn_rate
[0m08:17:30.085582 [debug] [Thread-3 (]: Writing runtime sql for node "model.personal_finance_tracker.fct_burn_rate"
[0m08:17:30.086578 [debug] [Thread-3 (]: Using duckdb connection "model.personal_finance_tracker.fct_burn_rate"
[0m08:17:30.088574 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: BEGIN
[0m08:17:30.089571 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:17:30.090569 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m08:17:30.091565 [debug] [Thread-3 (]: Using duckdb connection "model.personal_finance_tracker.fct_burn_rate"
[0m08:17:30.093561 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.fct_burn_rate"} */

  
    
    

    create  table
      "personal_finance"."main"."fct_burn_rate__dbt_tmp"
  
    as (
      -- Marts layer: Calculate daily burn rate with rolling averages
-- Focus: Window functions for trend analysis

with daily_spend as (
    select
        transaction_date,
        sum(amount) as daily_total,
        count(*) as transaction_count
    from "personal_finance"."main"."stg_transactions"
    group by transaction_date
),

burn_rate_calc as (
    select
        transaction_date,
        daily_total,
        transaction_count,
        
        -- 7-day rolling average (window function #1)
        avg(daily_total) over (
            order by transaction_date
            rows between 6 preceding and current row
        ) as avg_7day_spend,
        
        -- Cumulative spend (window function #2)
        sum(daily_total) over (
            order by transaction_date
            rows between unbounded preceding and current row
        ) as cumulative_spend,
        
        -- Running transaction count (window function #3)
        sum(transaction_count) over (
            order by transaction_date
            rows between unbounded preceding and current row
        ) as cumulative_transactions,
        
        -- Day-over-day change (window function #4)
        daily_total - lag(daily_total, 1) over (
            order by transaction_date
        ) as day_over_day_change,
        
        -- Percentage change from previous day (window function #5)
        round(
            ((daily_total - lag(daily_total, 1) over (order by transaction_date)) 
            / nullif(lag(daily_total, 1) over (order by transaction_date), 0)) * 100,
            2
        ) as pct_change_from_prev_day,
        
        -- Rank days by spending (window function #6)
        rank() over (order by daily_total desc) as spend_rank
        
    from daily_spend
)

select * from burn_rate_calc
order by transaction_date
    );
  
  
[0m08:17:30.134805 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m08:17:30.143780 [debug] [Thread-3 (]: Using duckdb connection "model.personal_finance_tracker.fct_burn_rate"
[0m08:17:30.144777 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.fct_burn_rate"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_burn_rate'
  
[0m08:17:30.146774 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m08:17:30.149765 [debug] [Thread-3 (]: Using duckdb connection "model.personal_finance_tracker.fct_burn_rate"
[0m08:17:30.150763 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.fct_burn_rate"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_burn_rate'
  
[0m08:17:30.152764 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m08:17:30.159737 [debug] [Thread-3 (]: Using duckdb connection "model.personal_finance_tracker.fct_burn_rate"
[0m08:17:30.160735 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.fct_burn_rate"} */
alter table "personal_finance"."main"."fct_burn_rate" rename to "fct_burn_rate__dbt_backup"
[0m08:17:30.162731 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m08:17:30.166719 [debug] [Thread-3 (]: Using duckdb connection "model.personal_finance_tracker.fct_burn_rate"
[0m08:17:30.167716 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.fct_burn_rate"} */
alter table "personal_finance"."main"."fct_burn_rate__dbt_tmp" rename to "fct_burn_rate"
[0m08:17:30.169721 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m08:17:30.177689 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: COMMIT
[0m08:17:30.178686 [debug] [Thread-3 (]: Using duckdb connection "model.personal_finance_tracker.fct_burn_rate"
[0m08:17:30.180682 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: COMMIT
[0m08:17:30.184267 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m08:17:30.190292 [debug] [Thread-3 (]: Using duckdb connection "model.personal_finance_tracker.fct_burn_rate"
[0m08:17:30.191251 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "model.personal_finance_tracker.fct_burn_rate"} */

      drop table if exists "personal_finance"."main"."fct_burn_rate__dbt_backup" cascade
    
[0m08:17:30.194166 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m08:17:30.196196 [debug] [Thread-3 (]: On model.personal_finance_tracker.fct_burn_rate: Close
[0m08:17:30.197195 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd476112d-f231-4995-a5dd-4174224cef7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D059182D0>]}
[0m08:17:30.199280 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.fct_burn_rate ........................... [[32mOK[0m in 0.17s]
[0m08:17:30.201148 [debug] [Thread-3 (]: Finished running node model.personal_finance_tracker.fct_burn_rate
[0m08:17:30.203141 [debug] [MainThread]: Using duckdb connection "master"
[0m08:17:30.204357 [debug] [MainThread]: On master: BEGIN
[0m08:17:30.205392 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:17:30.206352 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:17:30.207387 [debug] [MainThread]: On master: COMMIT
[0m08:17:30.208384 [debug] [MainThread]: Using duckdb connection "master"
[0m08:17:30.209381 [debug] [MainThread]: On master: COMMIT
[0m08:17:30.210342 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:17:30.211345 [debug] [MainThread]: On master: Close
[0m08:17:30.213335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:17:30.214331 [debug] [MainThread]: Connection 'create_personal_finance_main' was properly closed.
[0m08:17:30.216328 [debug] [MainThread]: Connection 'list_personal_finance_main' was properly closed.
[0m08:17:30.218325 [debug] [MainThread]: Connection 'model.personal_finance_tracker.stg_transactions' was properly closed.
[0m08:17:30.219322 [debug] [MainThread]: Connection 'model.personal_finance_tracker.fct_burn_rate' was properly closed.
[0m08:17:30.221313 [info ] [MainThread]: 
[0m08:17:30.222309 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m08:17:30.224305 [debug] [MainThread]: Command end result
[0m08:17:30.277774 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:17:30.282732 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:17:30.293705 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\personal_finance_tracker\personal_finance_tracker\target\run_results.json
[0m08:17:30.295698 [info ] [MainThread]: 
[0m08:17:30.296695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:17:30.297692 [info ] [MainThread]: 
[0m08:17:30.299689 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m08:17:30.300684 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:17:30.303992 [debug] [MainThread]: Command `dbt run` succeeded at 08:17:30.303992 after 3.23 seconds
[0m08:17:30.305993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D7CD0D010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D7CF59B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D7D238AD0>]}
[0m08:17:30.306985 [debug] [MainThread]: Flushing usage events
[0m08:17:31.324090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:18:25.646642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC7FA6D990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC7FCE4C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC7FCE4A90>]}


============================== 08:18:25.654074 | 0d5d4822-32b9-4269-b28b-61f2c7d60cd0 ==============================
[0m08:18:25.654074 [info ] [MainThread]: Running with dbt=1.11.2
[0m08:18:25.656070 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\personal_finance_tracker\\personal_finance_tracker\\logs'}
[0m08:18:26.125621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d5d4822-32b9-4269-b28b-61f2c7d60cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC7FD91410>]}
[0m08:18:26.241499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d5d4822-32b9-4269-b28b-61f2c7d60cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC7C520350>]}
[0m08:18:26.246978 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:18:26.713459 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m08:18:27.039976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:18:27.040935 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m08:18:27.040935 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:18:27.125951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d5d4822-32b9-4269-b28b-61f2c7d60cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC01255AD0>]}
[0m08:18:27.377241 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:18:27.390307 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:18:27.513272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d5d4822-32b9-4269-b28b-61f2c7d60cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC014F2090>]}
[0m08:18:27.515266 [info ] [MainThread]: Found 1 seed, 2 models, 7 data tests, 472 macros
[0m08:18:27.517260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d5d4822-32b9-4269-b28b-61f2c7d60cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC7FD91350>]}
[0m08:18:27.521251 [info ] [MainThread]: 
[0m08:18:27.523247 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:18:27.525239 [info ] [MainThread]: 
[0m08:18:27.527234 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:18:27.543637 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance_main'
[0m08:18:27.731864 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:18:27.732892 [debug] [ThreadPool]: On list_personal_finance_main: BEGIN
[0m08:18:27.733859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:18:27.783538 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m08:18:27.785533 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:18:27.787528 [debug] [ThreadPool]: On list_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance_main"} */
select
      'personal_finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'personal_finance'
  
[0m08:18:27.816448 [debug] [ThreadPool]: SQL status: OK in 0.028 seconds
[0m08:18:27.821436 [debug] [ThreadPool]: On list_personal_finance_main: ROLLBACK
[0m08:18:27.824467 [debug] [ThreadPool]: Failed to rollback 'list_personal_finance_main'
[0m08:18:27.824467 [debug] [ThreadPool]: On list_personal_finance_main: Close
[0m08:18:27.826592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d5d4822-32b9-4269-b28b-61f2c7d60cd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC011C4990>]}
[0m08:18:27.828116 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:27.829114 [debug] [MainThread]: On master: BEGIN
[0m08:18:27.829114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:18:27.831110 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:18:27.832106 [debug] [MainThread]: On master: COMMIT
[0m08:18:27.833104 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:27.834101 [debug] [MainThread]: On master: COMMIT
[0m08:18:27.835098 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:18:27.836132 [debug] [MainThread]: On master: Close
[0m08:18:27.843076 [debug] [Thread-1 (]: Began running node test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6
[0m08:18:27.843076 [debug] [Thread-2 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8
[0m08:18:27.844110 [debug] [Thread-3 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e
[0m08:18:27.844110 [debug] [Thread-4 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e
[0m08:18:27.845070 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_transactions_account_type__Checking__Credit_Card  [RUN]
[0m08:18:27.846073 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_transactions_account_type ....................... [RUN]
[0m08:18:27.848065 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_transactions_amount ............................. [RUN]
[0m08:18:27.851250 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6'
[0m08:18:27.849063 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_transactions_merchant_clean ..................... [RUN]
[0m08:18:27.853245 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8'
[0m08:18:27.854244 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e'
[0m08:18:27.855239 [debug] [Thread-1 (]: Began compiling node test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6
[0m08:18:27.857235 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e'
[0m08:18:27.858232 [debug] [Thread-2 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8
[0m08:18:27.859265 [debug] [Thread-3 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e
[0m08:18:27.903399 [debug] [Thread-1 (]: Writing injected SQL for node "test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6"
[0m08:18:27.904436 [debug] [Thread-4 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e
[0m08:18:27.918399 [debug] [Thread-2 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8"
[0m08:18:27.925343 [debug] [Thread-3 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e"
[0m08:18:27.936312 [debug] [Thread-4 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e"
[0m08:18:27.937310 [debug] [Thread-1 (]: Began executing node test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6
[0m08:18:27.967439 [debug] [Thread-1 (]: Writing runtime sql for node "test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6"
[0m08:18:27.970431 [debug] [Thread-1 (]: Using duckdb connection "test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6"
[0m08:18:27.971429 [debug] [Thread-1 (]: On test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6: BEGIN
[0m08:18:27.972427 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:18:27.973460 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m08:18:27.974457 [debug] [Thread-1 (]: Using duckdb connection "test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6"
[0m08:18:27.975456 [debug] [Thread-1 (]: On test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        account_type as value_field,
        count(*) as n_records

    from "personal_finance"."main"."stg_transactions"
    group by account_type

)

select *
from all_values
where value_field not in (
    'Checking','Credit Card'
)



  
  
      
    ) dbt_internal_test
[0m08:18:27.996100 [debug] [Thread-2 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8
[0m08:18:28.005345 [debug] [Thread-2 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8"
[0m08:18:28.006347 [debug] [Thread-4 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e
[0m08:18:28.007377 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m08:18:28.008338 [debug] [Thread-3 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e
[0m08:18:28.014321 [debug] [Thread-4 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e"
[0m08:18:28.016316 [debug] [Thread-2 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8"
[0m08:18:28.023333 [debug] [Thread-1 (]: On test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6: ROLLBACK
[0m08:18:28.027287 [debug] [Thread-3 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e"
[0m08:18:28.029510 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8: BEGIN
[0m08:18:28.030506 [debug] [Thread-4 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e"
[0m08:18:28.032503 [debug] [Thread-1 (]: Failed to rollback 'test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6'
[0m08:18:28.034571 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:18:28.035569 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e: BEGIN
[0m08:18:28.036571 [debug] [Thread-3 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e"
[0m08:18:28.037567 [debug] [Thread-1 (]: On test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6: Close
[0m08:18:28.039570 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m08:18:28.040561 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:18:28.041554 [debug] [Thread-3 (]: On test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m08:18:28.044546 [debug] [Thread-2 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8"
[0m08:18:28.043552 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_transactions_account_type__Checking__Credit_Card  [[32mPASS[0m in 0.19s]
[0m08:18:28.046541 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:18:28.047570 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m08:18:28.053559 [debug] [Thread-4 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e"
[0m08:18:28.049567 [debug] [Thread-1 (]: Finished running node test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6
[0m08:18:28.052560 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m08:18:28.048571 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select account_type
from "personal_finance"."main"."stg_transactions"
where account_type is null



  
  
      
    ) dbt_internal_test
[0m08:18:28.055552 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select merchant_clean
from "personal_finance"."main"."stg_transactions"
where merchant_clean is null



  
  
      
    ) dbt_internal_test
[0m08:18:28.058548 [debug] [Thread-1 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c
[0m08:18:28.059541 [debug] [Thread-3 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e"
[0m08:18:28.063533 [debug] [Thread-3 (]: On test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "personal_finance"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m08:18:28.062536 [info ] [Thread-1 (]: 5 of 7 START test not_null_stg_transactions_transaction_date ................... [RUN]
[0m08:18:28.066524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6, now test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c)
[0m08:18:28.067522 [debug] [Thread-1 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c
[0m08:18:28.076656 [debug] [Thread-1 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c"
[0m08:18:28.077744 [debug] [Thread-1 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c
[0m08:18:28.085240 [debug] [Thread-1 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c"
[0m08:18:28.086236 [debug] [Thread-2 (]: SQL status: OK in 0.026 seconds
[0m08:18:28.088230 [debug] [Thread-4 (]: SQL status: OK in 0.027 seconds
[0m08:18:28.088230 [debug] [Thread-3 (]: SQL status: OK in 0.023 seconds
[0m08:18:28.092219 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8: ROLLBACK
[0m08:18:28.093216 [debug] [Thread-1 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c"
[0m08:18:28.096207 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e: ROLLBACK
[0m08:18:28.099200 [debug] [Thread-3 (]: On test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m08:18:28.100197 [debug] [Thread-2 (]: Failed to rollback 'test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8'
[0m08:18:28.102193 [debug] [Thread-1 (]: On test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m08:18:28.104188 [debug] [Thread-4 (]: Failed to rollback 'test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e'
[0m08:18:28.106181 [debug] [Thread-3 (]: Failed to rollback 'test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e'
[0m08:18:28.106181 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8: Close
[0m08:18:28.107179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:18:28.108178 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e: Close
[0m08:18:28.109174 [debug] [Thread-3 (]: On test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e: Close
[0m08:18:28.111176 [info ] [Thread-2 (]: 2 of 7 PASS not_null_stg_transactions_account_type ............................. [[32mPASS[0m in 0.26s]
[0m08:18:28.112167 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:18:28.114163 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_transactions_merchant_clean ........................... [[32mPASS[0m in 0.26s]
[0m08:18:28.117153 [debug] [Thread-2 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8
[0m08:18:28.115158 [info ] [Thread-3 (]: 3 of 7 PASS not_null_stg_transactions_amount ................................... [[32mPASS[0m in 0.26s]
[0m08:18:28.119148 [debug] [Thread-1 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c"
[0m08:18:28.120145 [debug] [Thread-4 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e
[0m08:18:28.122140 [debug] [Thread-2 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957
[0m08:18:28.123150 [debug] [Thread-3 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e
[0m08:18:28.125131 [debug] [Thread-1 (]: On test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "personal_finance"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m08:18:28.127125 [debug] [Thread-4 (]: Began running node test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7
[0m08:18:28.128124 [info ] [Thread-2 (]: 6 of 7 START test not_null_stg_transactions_txn_id ............................. [RUN]
[0m08:18:28.133110 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8, now test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957)
[0m08:18:28.132115 [info ] [Thread-4 (]: 7 of 7 START test unique_stg_transactions_txn_id ............................... [RUN]
[0m08:18:28.135107 [debug] [Thread-2 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957
[0m08:18:28.136102 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:18:28.137100 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e, now test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7)
[0m08:18:28.147073 [debug] [Thread-2 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957"
[0m08:18:28.150064 [debug] [Thread-1 (]: On test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m08:18:28.151062 [debug] [Thread-4 (]: Began compiling node test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7
[0m08:18:28.155463 [debug] [Thread-1 (]: Failed to rollback 'test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c'
[0m08:18:28.156459 [debug] [Thread-2 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957
[0m08:18:28.171419 [debug] [Thread-4 (]: Writing injected SQL for node "test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7"
[0m08:18:28.172416 [debug] [Thread-1 (]: On test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m08:18:28.176499 [debug] [Thread-2 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957"
[0m08:18:28.180487 [debug] [Thread-4 (]: Began executing node test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7
[0m08:18:28.193451 [debug] [Thread-4 (]: Writing runtime sql for node "test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7"
[0m08:18:28.179586 [info ] [Thread-1 (]: 5 of 7 PASS not_null_stg_transactions_transaction_date ......................... [[32mPASS[0m in 0.11s]
[0m08:18:28.194449 [debug] [Thread-2 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957"
[0m08:18:28.196445 [debug] [Thread-1 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c
[0m08:18:28.197442 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957: BEGIN
[0m08:18:28.198438 [debug] [Thread-4 (]: Using duckdb connection "test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7"
[0m08:18:28.200433 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:18:28.202429 [debug] [Thread-4 (]: On test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7: BEGIN
[0m08:18:28.205422 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:18:28.206418 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m08:18:28.207414 [debug] [Thread-2 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957"
[0m08:18:28.208413 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m08:18:28.209408 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from "personal_finance"."main"."stg_transactions"
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m08:18:28.210414 [debug] [Thread-4 (]: Using duckdb connection "test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7"
[0m08:18:28.212407 [debug] [Thread-4 (]: On test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    txn_id as unique_field,
    count(*) as n_records

from "personal_finance"."main"."stg_transactions"
where txn_id is not null
group by txn_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:18:28.215392 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m08:18:28.218385 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957: ROLLBACK
[0m08:18:28.220382 [debug] [Thread-2 (]: Failed to rollback 'test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957'
[0m08:18:28.221377 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957: Close
[0m08:18:28.223374 [info ] [Thread-2 (]: 6 of 7 PASS not_null_stg_transactions_txn_id ................................... [[32mPASS[0m in 0.09s]
[0m08:18:28.224468 [debug] [Thread-2 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957
[0m08:18:28.230329 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m08:18:28.233324 [debug] [Thread-4 (]: On test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7: ROLLBACK
[0m08:18:28.234321 [debug] [Thread-4 (]: Failed to rollback 'test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7'
[0m08:18:28.235319 [debug] [Thread-4 (]: On test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7: Close
[0m08:18:28.237314 [info ] [Thread-4 (]: 7 of 7 PASS unique_stg_transactions_txn_id ..................................... [[32mPASS[0m in 0.10s]
[0m08:18:28.239309 [debug] [Thread-4 (]: Finished running node test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7
[0m08:18:28.242300 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:28.243299 [debug] [MainThread]: On master: BEGIN
[0m08:18:28.244295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:18:28.246291 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m08:18:28.248285 [debug] [MainThread]: On master: COMMIT
[0m08:18:28.250443 [debug] [MainThread]: Using duckdb connection "master"
[0m08:18:28.251442 [debug] [MainThread]: On master: COMMIT
[0m08:18:28.253437 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m08:18:28.254435 [debug] [MainThread]: On master: Close
[0m08:18:28.255433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:18:28.257427 [debug] [MainThread]: Connection 'list_personal_finance_main' was properly closed.
[0m08:18:28.259420 [debug] [MainThread]: Connection 'test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m08:18:28.260418 [debug] [MainThread]: Connection 'test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957' was properly closed.
[0m08:18:28.261414 [debug] [MainThread]: Connection 'test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e' was properly closed.
[0m08:18:28.262412 [debug] [MainThread]: Connection 'test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7' was properly closed.
[0m08:18:28.263409 [info ] [MainThread]: 
[0m08:18:28.264406 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m08:18:28.267398 [debug] [MainThread]: Command end result
[0m08:18:28.320595 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:18:28.324584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:18:28.336552 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\personal_finance_tracker\personal_finance_tracker\target\run_results.json
[0m08:18:28.337550 [info ] [MainThread]: 
[0m08:18:28.338547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:18:28.339544 [info ] [MainThread]: 
[0m08:18:28.341539 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m08:18:28.343534 [debug] [MainThread]: Command `dbt test` succeeded at 08:18:28.343534 after 2.83 seconds
[0m08:18:28.344531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC79308AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC78D4D010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC017BFD90>]}
[0m08:18:28.345529 [debug] [MainThread]: Flushing usage events
[0m08:18:29.274336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:22:54.738338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022626E74D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022626E772D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022626E74290>]}


============================== 08:22:54.744358 | 50a45cd3-6384-43bc-8651-3523233720a3 ==============================
[0m08:22:54.744358 [info ] [MainThread]: Running with dbt=1.11.2
[0m08:22:54.746316 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs generate', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\personal_finance_tracker\\personal_finance_tracker\\logs'}
[0m08:22:55.213421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50a45cd3-6384-43bc-8651-3523233720a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022626F19F50>]}
[0m08:22:55.332070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50a45cd3-6384-43bc-8651-3523233720a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226236A0290>]}
[0m08:22:55.337096 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:22:55.783750 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m08:22:56.025438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:22:56.026434 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m08:22:56.027431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:22:56.323766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50a45cd3-6384-43bc-8651-3523233720a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002262802C590>]}
[0m08:22:56.375547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50a45cd3-6384-43bc-8651-3523233720a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226284F9690>]}
[0m08:22:56.376546 [info ] [MainThread]: Found 1 seed, 2 models, 7 data tests, 472 macros
[0m08:22:56.377541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50a45cd3-6384-43bc-8651-3523233720a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022626F3CB50>]}
[0m08:22:56.381653 [info ] [MainThread]: 
[0m08:22:56.382615 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:22:56.384611 [info ] [MainThread]: 
[0m08:22:56.386642 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:22:56.394622 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance_main'
[0m08:22:56.515795 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:22:56.516788 [debug] [ThreadPool]: On list_personal_finance_main: BEGIN
[0m08:22:56.517750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:22:56.544667 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m08:22:56.545668 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:22:56.546627 [debug] [ThreadPool]: On list_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance_main"} */
select
      'personal_finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'personal_finance'
  
[0m08:22:56.571823 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m08:22:56.573855 [debug] [ThreadPool]: On list_personal_finance_main: ROLLBACK
[0m08:22:56.575944 [debug] [ThreadPool]: Failed to rollback 'list_personal_finance_main'
[0m08:22:56.575944 [debug] [ThreadPool]: On list_personal_finance_main: Close
[0m08:22:56.579209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50a45cd3-6384-43bc-8651-3523233720a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022626F2A9D0>]}
[0m08:22:56.586861 [debug] [Thread-1 (]: Began running node seed.personal_finance_tracker.raw_bank_transactions
[0m08:22:56.587841 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.personal_finance_tracker.raw_bank_transactions'
[0m08:22:56.588838 [debug] [Thread-1 (]: Began compiling node seed.personal_finance_tracker.raw_bank_transactions
[0m08:22:56.602939 [debug] [Thread-1 (]: Began executing node seed.personal_finance_tracker.raw_bank_transactions
[0m08:22:56.604096 [debug] [Thread-1 (]: Finished running node seed.personal_finance_tracker.raw_bank_transactions
[0m08:22:56.605097 [debug] [Thread-3 (]: Began running node model.personal_finance_tracker.stg_transactions
[0m08:22:56.607126 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.personal_finance_tracker.stg_transactions'
[0m08:22:56.607126 [debug] [Thread-3 (]: Began compiling node model.personal_finance_tracker.stg_transactions
[0m08:22:56.613110 [debug] [Thread-3 (]: Writing injected SQL for node "model.personal_finance_tracker.stg_transactions"
[0m08:22:56.615068 [debug] [Thread-3 (]: Began executing node model.personal_finance_tracker.stg_transactions
[0m08:22:56.616066 [debug] [Thread-3 (]: Finished running node model.personal_finance_tracker.stg_transactions
[0m08:22:56.618060 [debug] [Thread-2 (]: Began running node model.personal_finance_tracker.fct_burn_rate
[0m08:22:56.619059 [debug] [Thread-1 (]: Began running node test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6
[0m08:22:56.620258 [debug] [Thread-4 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8
[0m08:22:56.621005 [debug] [Thread-3 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e
[0m08:22:56.621745 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.personal_finance_tracker.fct_burn_rate'
[0m08:22:56.622748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.personal_finance_tracker.raw_bank_transactions, now test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6)
[0m08:22:56.623747 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8'
[0m08:22:56.624913 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.personal_finance_tracker.stg_transactions, now test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e)
[0m08:22:56.625911 [debug] [Thread-2 (]: Began compiling node model.personal_finance_tracker.fct_burn_rate
[0m08:22:56.626907 [debug] [Thread-1 (]: Began compiling node test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6
[0m08:22:56.627907 [debug] [Thread-4 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8
[0m08:22:56.628968 [debug] [Thread-3 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e
[0m08:22:56.628968 [debug] [Thread-2 (]: Writing injected SQL for node "model.personal_finance_tracker.fct_burn_rate"
[0m08:22:56.655530 [debug] [Thread-1 (]: Writing injected SQL for node "test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6"
[0m08:22:56.671487 [debug] [Thread-4 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8"
[0m08:22:56.678877 [debug] [Thread-3 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e"
[0m08:22:56.678877 [debug] [Thread-2 (]: Began executing node model.personal_finance_tracker.fct_burn_rate
[0m08:22:56.678877 [debug] [Thread-1 (]: Began executing node test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6
[0m08:22:56.678877 [debug] [Thread-4 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8
[0m08:22:56.687400 [debug] [Thread-2 (]: Finished running node model.personal_finance_tracker.fct_burn_rate
[0m08:22:56.687400 [debug] [Thread-3 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e
[0m08:22:56.687400 [debug] [Thread-1 (]: Finished running node test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6
[0m08:22:56.692405 [debug] [Thread-4 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8
[0m08:22:56.692405 [debug] [Thread-2 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e
[0m08:22:56.692405 [debug] [Thread-3 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e
[0m08:22:56.697453 [debug] [Thread-1 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c
[0m08:22:56.699014 [debug] [Thread-4 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957
[0m08:22:56.700165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.personal_finance_tracker.fct_burn_rate, now test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e)
[0m08:22:56.700968 [debug] [Thread-3 (]: Began running node test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7
[0m08:22:56.701969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6, now test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c)
[0m08:22:56.703002 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8, now test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957)
[0m08:22:56.704256 [debug] [Thread-2 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e
[0m08:22:56.705253 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e, now test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7)
[0m08:22:56.706261 [debug] [Thread-1 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c
[0m08:22:56.707251 [debug] [Thread-4 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957
[0m08:22:56.716261 [debug] [Thread-2 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e"
[0m08:22:56.717222 [debug] [Thread-3 (]: Began compiling node test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7
[0m08:22:56.781091 [debug] [Thread-1 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c"
[0m08:22:56.788067 [debug] [Thread-4 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957"
[0m08:22:56.805659 [debug] [Thread-3 (]: Writing injected SQL for node "test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7"
[0m08:22:56.807652 [debug] [Thread-2 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e
[0m08:22:56.810645 [debug] [Thread-4 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957
[0m08:22:56.813636 [debug] [Thread-2 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e
[0m08:22:56.814633 [debug] [Thread-1 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c
[0m08:22:56.817625 [debug] [Thread-4 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957
[0m08:22:56.821615 [debug] [Thread-1 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c
[0m08:22:56.822612 [debug] [Thread-3 (]: Began executing node test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7
[0m08:22:56.825727 [debug] [Thread-3 (]: Finished running node test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7
[0m08:22:56.827721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:22:56.828719 [debug] [MainThread]: Connection 'list_personal_finance_main' was properly closed.
[0m08:22:56.829718 [debug] [MainThread]: Connection 'test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m08:22:56.829718 [debug] [MainThread]: Connection 'test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7' was properly closed.
[0m08:22:56.830714 [debug] [MainThread]: Connection 'test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e' was properly closed.
[0m08:22:56.832706 [debug] [MainThread]: Connection 'test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957' was properly closed.
[0m08:22:56.835698 [debug] [MainThread]: Command end result
[0m08:22:56.981493 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:22:56.985482 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:22:56.998448 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\personal_finance_tracker\personal_finance_tracker\target\run_results.json
[0m08:23:03.089682 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m08:23:03.091677 [info ] [MainThread]: Building catalog
[0m08:23:03.125149 [debug] [ThreadPool]: Acquiring new duckdb connection 'personal_finance.information_schema'
[0m08:23:03.141457 [debug] [ThreadPool]: Using duckdb connection "personal_finance.information_schema"
[0m08:23:03.143451 [debug] [ThreadPool]: On personal_finance.information_schema: BEGIN
[0m08:23:03.145322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:23:03.147317 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m08:23:03.148317 [debug] [ThreadPool]: Using duckdb connection "personal_finance.information_schema"
[0m08:23:03.148317 [debug] [ThreadPool]: On personal_finance.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "personal_finance.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'personal_finance'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'personal_finance'
    )
    select
        'personal_finance' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m08:23:03.189148 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m08:23:03.195135 [debug] [ThreadPool]: On personal_finance.information_schema: ROLLBACK
[0m08:23:03.196133 [debug] [ThreadPool]: Failed to rollback 'personal_finance.information_schema'
[0m08:23:03.196133 [debug] [ThreadPool]: On personal_finance.information_schema: Close
[0m08:23:03.214084 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\kev\personal_finance_tracker\personal_finance_tracker\target\catalog.json
[0m08:23:03.267810 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:23:03.271834 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:23:03.272796 [info ] [MainThread]: Catalog written to C:\kev\personal_finance_tracker\personal_finance_tracker\target\catalog.json
[0m08:23:03.274918 [debug] [MainThread]: Command `dbt docs generate` succeeded at 08:23:03.274918 after 8.68 seconds
[0m08:23:03.275917 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:23:03.276913 [debug] [MainThread]: Connection 'personal_finance.information_schema' was properly closed.
[0m08:23:03.277790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022625E26510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022625DE74D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022620199CD0>]}
[0m08:23:03.278796 [debug] [MainThread]: Flushing usage events
[0m08:23:04.361828 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:23:51.097989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121889B0B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121889B3210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121889B3090>]}


============================== 08:23:51.104307 | 757dc8b1-e62a-4e5a-b16e-ebf8802828de ==============================
[0m08:23:51.104307 [info ] [MainThread]: Running with dbt=1.11.2
[0m08:23:51.106266 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\personal_finance_tracker\\personal_finance_tracker\\logs'}
[0m08:23:51.598108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '757dc8b1-e62a-4e5a-b16e-ebf8802828de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012188993250>]}
[0m08:23:51.723099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '757dc8b1-e62a-4e5a-b16e-ebf8802828de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121879A4650>]}
[0m08:35:47.397027 [error] [MainThread]: Encountered an error:

[0m08:35:47.686253 [error] [MainThread]: Traceback (most recent call last):
  File "C:\kev\personal_finance_tracker\venv\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\kev\personal_finance_tracker\venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\kev\personal_finance_tracker\venv\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\kev\personal_finance_tracker\venv\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\kev\personal_finance_tracker\venv\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\kev\personal_finance_tracker\venv\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\kev\personal_finance_tracker\venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\Evans Moseti\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Evans Moseti\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Evans Moseti\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m08:35:47.693234 [debug] [MainThread]: Command `dbt docs serve` failed at 08:35:47.693234 after 716.74 seconds
[0m08:35:47.694268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012188A13E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012188A13E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012188A5B090>]}
[0m08:35:47.695264 [debug] [MainThread]: Flushing usage events
[0m08:35:48.744114 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:35:59.382298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC1E44850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC1E44210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC1E47090>]}


============================== 08:35:59.390820 | bc627049-2676-4240-8f5d-a035f738f0f2 ==============================
[0m08:35:59.390820 [info ] [MainThread]: Running with dbt=1.11.2
[0m08:35:59.392779 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\personal_finance_tracker\\personal_finance_tracker\\logs'}
[0m08:35:59.796144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc627049-2676-4240-8f5d-a035f738f0f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC1EE9190>]}
[0m08:35:59.898443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc627049-2676-4240-8f5d-a035f738f0f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC1E46790>]}
[0m08:35:59.904615 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m08:36:00.428102 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m08:36:00.775195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:36:00.776192 [debug] [MainThread]: Partial parsing: added file: personal_finance_tracker://models\marts\marts_schema.yml
[0m08:36:01.366179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc627049-2676-4240-8f5d-a035f738f0f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC3102ED0>]}
[0m08:36:01.576232 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:36:01.585945 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:36:01.661419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc627049-2676-4240-8f5d-a035f738f0f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC1F1CF50>]}
[0m08:36:01.663414 [info ] [MainThread]: Found 1 seed, 2 models, 13 data tests, 472 macros
[0m08:36:01.664413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc627049-2676-4240-8f5d-a035f738f0f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC34B9D50>]}
[0m08:36:01.669435 [info ] [MainThread]: 
[0m08:36:01.670398 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:36:01.672391 [info ] [MainThread]: 
[0m08:36:01.673389 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:36:01.688384 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_personal_finance_main'
[0m08:36:01.825987 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:36:01.826988 [debug] [ThreadPool]: On list_personal_finance_main: BEGIN
[0m08:36:01.828124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:01.906211 [debug] [ThreadPool]: SQL status: OK in 0.078 seconds
[0m08:36:01.906211 [debug] [ThreadPool]: Using duckdb connection "list_personal_finance_main"
[0m08:36:01.907247 [debug] [ThreadPool]: On list_personal_finance_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "connection_name": "list_personal_finance_main"} */
select
      'personal_finance' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'personal_finance'
  
[0m08:36:02.022291 [debug] [ThreadPool]: SQL status: OK in 0.114 seconds
[0m08:36:02.027793 [debug] [ThreadPool]: On list_personal_finance_main: ROLLBACK
[0m08:36:02.030787 [debug] [ThreadPool]: Failed to rollback 'list_personal_finance_main'
[0m08:36:02.031786 [debug] [ThreadPool]: On list_personal_finance_main: Close
[0m08:36:02.036196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc627049-2676-4240-8f5d-a035f738f0f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC34B9D50>]}
[0m08:36:02.037172 [debug] [MainThread]: Using duckdb connection "master"
[0m08:36:02.038169 [debug] [MainThread]: On master: BEGIN
[0m08:36:02.039166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:36:02.040164 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m08:36:02.041161 [debug] [MainThread]: On master: COMMIT
[0m08:36:02.042160 [debug] [MainThread]: Using duckdb connection "master"
[0m08:36:02.043156 [debug] [MainThread]: On master: COMMIT
[0m08:36:02.044152 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:36:02.045151 [debug] [MainThread]: On master: Close
[0m08:36:02.058651 [debug] [Thread-1 (]: Began running node test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6
[0m08:36:02.059655 [debug] [Thread-2 (]: Began running node test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532
[0m08:36:02.059655 [debug] [Thread-3 (]: Began running node test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3
[0m08:36:02.060991 [debug] [Thread-4 (]: Began running node test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f
[0m08:36:02.060991 [info ] [Thread-1 (]: 1 of 13 START test accepted_values_stg_transactions_account_type__Checking__Credit_Card  [RUN]
[0m08:36:02.062990 [info ] [Thread-2 (]: 2 of 13 START test not_null_fct_burn_rate_avg_7day_spend ....................... [RUN]
[0m08:36:02.064033 [info ] [Thread-3 (]: 3 of 13 START test not_null_fct_burn_rate_cumulative_spend ..................... [RUN]
[0m08:36:02.067071 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6'
[0m08:36:02.066073 [info ] [Thread-4 (]: 4 of 13 START test not_null_fct_burn_rate_daily_total .......................... [RUN]
[0m08:36:02.070061 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532'
[0m08:36:02.071060 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3'
[0m08:36:02.072058 [debug] [Thread-1 (]: Began compiling node test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6
[0m08:36:02.074050 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f'
[0m08:36:02.075049 [debug] [Thread-2 (]: Began compiling node test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532
[0m08:36:02.076045 [debug] [Thread-3 (]: Began compiling node test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3
[0m08:36:02.117259 [debug] [Thread-1 (]: Writing injected SQL for node "test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6"
[0m08:36:02.118291 [debug] [Thread-4 (]: Began compiling node test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f
[0m08:36:02.134564 [debug] [Thread-2 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532"
[0m08:36:02.141510 [debug] [Thread-3 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3"
[0m08:36:02.151484 [debug] [Thread-4 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f"
[0m08:36:02.152482 [debug] [Thread-1 (]: Began executing node test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6
[0m08:36:02.184395 [debug] [Thread-1 (]: Writing runtime sql for node "test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6"
[0m08:36:02.185393 [debug] [Thread-2 (]: Began executing node test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532
[0m08:36:02.187387 [debug] [Thread-4 (]: Began executing node test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f
[0m08:36:02.188384 [debug] [Thread-3 (]: Began executing node test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3
[0m08:36:02.195402 [debug] [Thread-2 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532"
[0m08:36:02.195402 [debug] [Thread-1 (]: Using duckdb connection "test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6"
[0m08:36:02.202539 [debug] [Thread-4 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f"
[0m08:36:02.208767 [debug] [Thread-3 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3"
[0m08:36:02.210760 [debug] [Thread-1 (]: On test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6: BEGIN
[0m08:36:02.213752 [debug] [Thread-2 (]: Using duckdb connection "test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532"
[0m08:36:02.214750 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:36:02.216746 [debug] [Thread-4 (]: Using duckdb connection "test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f"
[0m08:36:02.217742 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532: BEGIN
[0m08:36:02.220733 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f: BEGIN
[0m08:36:02.221730 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:36:02.222728 [debug] [Thread-3 (]: Using duckdb connection "test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3"
[0m08:36:02.223724 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:36:02.225845 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:36:02.226843 [debug] [Thread-1 (]: Using duckdb connection "test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6"
[0m08:36:02.227839 [debug] [Thread-3 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3: BEGIN
[0m08:36:02.229954 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m08:36:02.230953 [debug] [Thread-1 (]: On test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        account_type as value_field,
        count(*) as n_records

    from "personal_finance"."main"."stg_transactions"
    group by account_type

)

select *
from all_values
where value_field not in (
    'Checking','Credit Card'
)



  
  
      
    ) dbt_internal_test
[0m08:36:02.231950 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m08:36:02.232949 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:36:02.233944 [debug] [Thread-2 (]: Using duckdb connection "test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532"
[0m08:36:02.235434 [debug] [Thread-4 (]: Using duckdb connection "test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f"
[0m08:36:02.237433 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_7day_spend
from "personal_finance"."main"."fct_burn_rate"
where avg_7day_spend is null



  
  
      
    ) dbt_internal_test
[0m08:36:02.238430 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m08:36:02.240425 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select daily_total
from "personal_finance"."main"."fct_burn_rate"
where daily_total is null



  
  
      
    ) dbt_internal_test
[0m08:36:02.242422 [debug] [Thread-3 (]: Using duckdb connection "test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3"
[0m08:36:02.244416 [debug] [Thread-3 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cumulative_spend
from "personal_finance"."main"."fct_burn_rate"
where cumulative_spend is null



  
  
      
    ) dbt_internal_test
[0m08:36:02.249503 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m08:36:02.250507 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m08:36:02.251500 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m08:36:02.260037 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f: ROLLBACK
[0m08:36:02.261044 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m08:36:02.263039 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532: ROLLBACK
[0m08:36:02.266031 [debug] [Thread-3 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3: ROLLBACK
[0m08:36:02.267027 [debug] [Thread-4 (]: Failed to rollback 'test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f'
[0m08:36:02.270022 [debug] [Thread-1 (]: On test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6: ROLLBACK
[0m08:36:02.272016 [debug] [Thread-2 (]: Failed to rollback 'test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532'
[0m08:36:02.273013 [debug] [Thread-3 (]: Failed to rollback 'test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3'
[0m08:36:02.274040 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f: Close
[0m08:36:02.275123 [debug] [Thread-1 (]: Failed to rollback 'test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6'
[0m08:36:02.276120 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532: Close
[0m08:36:02.276120 [debug] [Thread-3 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3: Close
[0m08:36:02.279113 [debug] [Thread-1 (]: On test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6: Close
[0m08:36:02.278118 [info ] [Thread-4 (]: 4 of 13 PASS not_null_fct_burn_rate_daily_total ................................ [[32mPASS[0m in 0.20s]
[0m08:36:02.279683 [info ] [Thread-2 (]: 2 of 13 PASS not_null_fct_burn_rate_avg_7day_spend ............................. [[32mPASS[0m in 0.21s]
[0m08:36:02.279683 [info ] [Thread-3 (]: 3 of 13 PASS not_null_fct_burn_rate_cumulative_spend ........................... [[32mPASS[0m in 0.21s]
[0m08:36:02.286168 [debug] [Thread-4 (]: Finished running node test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f
[0m08:36:02.279683 [info ] [Thread-1 (]: 1 of 13 PASS accepted_values_stg_transactions_account_type__Checking__Credit_Card  [[32mPASS[0m in 0.21s]
[0m08:36:02.288163 [debug] [Thread-2 (]: Finished running node test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532
[0m08:36:02.289160 [debug] [Thread-3 (]: Finished running node test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3
[0m08:36:02.291153 [debug] [Thread-4 (]: Began running node test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4
[0m08:36:02.292151 [debug] [Thread-1 (]: Finished running node test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6
[0m08:36:02.295146 [debug] [Thread-2 (]: Began running node test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729
[0m08:36:02.297137 [debug] [Thread-3 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8
[0m08:36:02.299132 [debug] [Thread-1 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e
[0m08:36:02.298135 [info ] [Thread-4 (]: 5 of 13 START test not_null_fct_burn_rate_transaction_count .................... [RUN]
[0m08:36:02.306690 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.not_null_fct_burn_rate_daily_total.c734c9bd6f, now test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4)
[0m08:36:02.300937 [info ] [Thread-2 (]: 6 of 13 START test not_null_fct_burn_rate_transaction_date ..................... [RUN]
[0m08:36:02.307679 [debug] [Thread-4 (]: Began compiling node test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4
[0m08:36:02.309285 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.not_null_fct_burn_rate_avg_7day_spend.7da4711532, now test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729)
[0m08:36:02.300937 [info ] [Thread-3 (]: 7 of 13 START test not_null_stg_transactions_account_type ...................... [RUN]
[0m08:36:02.319067 [debug] [Thread-4 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4"
[0m08:36:02.305684 [info ] [Thread-1 (]: 8 of 13 START test not_null_stg_transactions_amount ............................ [RUN]
[0m08:36:02.327778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.accepted_values_stg_transactions_account_type__Checking__Credit_Card.d5b67bc9f6, now test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e)
[0m08:36:02.327778 [debug] [Thread-1 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e
[0m08:36:02.319067 [debug] [Thread-2 (]: Began compiling node test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729
[0m08:36:02.319067 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.not_null_fct_burn_rate_cumulative_spend.866901dff3, now test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8)
[0m08:36:02.352132 [debug] [Thread-1 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e"
[0m08:36:02.357669 [debug] [Thread-2 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729"
[0m08:36:02.357669 [debug] [Thread-3 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8
[0m08:36:02.357669 [debug] [Thread-4 (]: Began executing node test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4
[0m08:36:02.357669 [debug] [Thread-1 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e
[0m08:36:02.357669 [debug] [Thread-2 (]: Began executing node test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729
[0m08:36:02.372590 [debug] [Thread-4 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4"
[0m08:36:02.385008 [debug] [Thread-3 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8"
[0m08:36:02.392992 [debug] [Thread-1 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e"
[0m08:36:02.402015 [debug] [Thread-2 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729"
[0m08:36:02.408998 [debug] [Thread-2 (]: Using duckdb connection "test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729"
[0m08:36:02.405006 [debug] [Thread-3 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8
[0m08:36:02.407000 [debug] [Thread-4 (]: Using duckdb connection "test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4"
[0m08:36:02.410989 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729: BEGIN
[0m08:36:02.411987 [debug] [Thread-1 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e"
[0m08:36:02.418016 [debug] [Thread-3 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8"
[0m08:36:02.422521 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4: BEGIN
[0m08:36:02.422521 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:36:02.422521 [debug] [Thread-1 (]: On test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e: BEGIN
[0m08:36:02.422521 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:36:02.427549 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m08:36:02.427549 [debug] [Thread-3 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8"
[0m08:36:02.427549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:02.432558 [debug] [Thread-2 (]: Using duckdb connection "test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729"
[0m08:36:02.432558 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m08:36:02.432558 [debug] [Thread-3 (]: On test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8: BEGIN
[0m08:36:02.437599 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "personal_finance"."main"."fct_burn_rate"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m08:36:02.437599 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:36:02.437599 [debug] [Thread-4 (]: Using duckdb connection "test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4"
[0m08:36:02.437599 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:36:02.437599 [debug] [Thread-1 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e"
[0m08:36:02.437599 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m08:36:02.437599 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_count
from "personal_finance"."main"."fct_burn_rate"
where transaction_count is null



  
  
      
    ) dbt_internal_test
[0m08:36:02.447560 [debug] [Thread-1 (]: On test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "personal_finance"."main"."stg_transactions"
where amount is null



  
  
      
    ) dbt_internal_test
[0m08:36:02.447560 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m08:36:02.447560 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729: ROLLBACK
[0m08:36:02.447560 [debug] [Thread-3 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8"
[0m08:36:02.447560 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m08:36:02.457798 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:36:02.457798 [debug] [Thread-2 (]: Failed to rollback 'test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729'
[0m08:36:02.460166 [debug] [Thread-3 (]: On test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select account_type
from "personal_finance"."main"."stg_transactions"
where account_type is null



  
  
      
    ) dbt_internal_test
[0m08:36:02.464154 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4: ROLLBACK
[0m08:36:02.465191 [debug] [Thread-1 (]: On test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e: ROLLBACK
[0m08:36:02.467716 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729: Close
[0m08:36:02.467716 [debug] [Thread-4 (]: Failed to rollback 'test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4'
[0m08:36:02.467716 [debug] [Thread-1 (]: Failed to rollback 'test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e'
[0m08:36:02.467716 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m08:36:02.467716 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4: Close
[0m08:36:02.467716 [info ] [Thread-2 (]: 6 of 13 PASS not_null_fct_burn_rate_transaction_date ........................... [[32mPASS[0m in 0.16s]
[0m08:36:02.477984 [debug] [Thread-1 (]: On test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e: Close
[0m08:36:02.481168 [debug] [Thread-3 (]: On test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8: ROLLBACK
[0m08:36:02.485158 [debug] [Thread-2 (]: Finished running node test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729
[0m08:36:02.483168 [info ] [Thread-4 (]: 5 of 13 PASS not_null_fct_burn_rate_transaction_count .......................... [[32mPASS[0m in 0.18s]
[0m08:36:02.489146 [debug] [Thread-3 (]: Failed to rollback 'test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8'
[0m08:36:02.491143 [debug] [Thread-2 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e
[0m08:36:02.487154 [info ] [Thread-1 (]: 8 of 13 PASS not_null_stg_transactions_amount .................................. [[32mPASS[0m in 0.16s]
[0m08:36:02.493137 [debug] [Thread-4 (]: Finished running node test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4
[0m08:36:02.495133 [debug] [Thread-3 (]: On test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8: Close
[0m08:36:02.501709 [debug] [Thread-1 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e
[0m08:36:02.499122 [info ] [Thread-2 (]: 9 of 13 START test not_null_stg_transactions_merchant_clean .................... [RUN]
[0m08:36:02.502705 [debug] [Thread-4 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c
[0m08:36:02.506695 [debug] [Thread-1 (]: Began running node test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957
[0m08:36:02.504700 [info ] [Thread-3 (]: 7 of 13 PASS not_null_stg_transactions_account_type ............................ [[32mPASS[0m in 0.19s]
[0m08:36:02.508780 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.not_null_fct_burn_rate_transaction_date.bbe7ea2729, now test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e)
[0m08:36:02.512786 [info ] [Thread-4 (]: 10 of 13 START test not_null_stg_transactions_transaction_date ................. [RUN]
[0m08:36:02.516796 [debug] [Thread-3 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8
[0m08:36:02.518304 [debug] [Thread-2 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e
[0m08:36:02.520299 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.not_null_fct_burn_rate_transaction_count.bbff64cab4, now test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c)
[0m08:36:02.522441 [debug] [Thread-3 (]: Began running node test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58
[0m08:36:02.512786 [info ] [Thread-1 (]: 11 of 13 START test not_null_stg_transactions_txn_id ........................... [RUN]
[0m08:36:02.534511 [debug] [Thread-2 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e"
[0m08:36:02.536504 [debug] [Thread-4 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c
[0m08:36:02.538501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.not_null_stg_transactions_amount.3629b5421e, now test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957)
[0m08:36:02.538501 [info ] [Thread-3 (]: 12 of 13 START test unique_fct_burn_rate_transaction_date ...................... [RUN]
[0m08:36:02.560283 [debug] [Thread-1 (]: Began compiling node test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957
[0m08:36:02.558892 [debug] [Thread-4 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c"
[0m08:36:02.560283 [debug] [Thread-2 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e
[0m08:36:02.560283 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.not_null_stg_transactions_account_type.ad1230bce8, now test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58)
[0m08:36:02.577773 [debug] [Thread-1 (]: Writing injected SQL for node "test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957"
[0m08:36:02.587713 [debug] [Thread-2 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e"
[0m08:36:02.587713 [debug] [Thread-4 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c
[0m08:36:02.587713 [debug] [Thread-3 (]: Began compiling node test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58
[0m08:36:02.587713 [debug] [Thread-1 (]: Began executing node test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957
[0m08:36:02.600647 [debug] [Thread-2 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e"
[0m08:36:02.606631 [debug] [Thread-4 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c"
[0m08:36:02.625581 [debug] [Thread-3 (]: Writing injected SQL for node "test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58"
[0m08:36:02.630567 [debug] [Thread-1 (]: Writing runtime sql for node "test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957"
[0m08:36:02.632564 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e: BEGIN
[0m08:36:02.634560 [debug] [Thread-4 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c"
[0m08:36:02.636554 [debug] [Thread-3 (]: Began executing node test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58
[0m08:36:02.637551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:36:02.639544 [debug] [Thread-1 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957"
[0m08:36:02.640542 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c: BEGIN
[0m08:36:02.645528 [debug] [Thread-3 (]: Writing runtime sql for node "test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58"
[0m08:36:02.647523 [debug] [Thread-1 (]: On test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957: BEGIN
[0m08:36:02.648533 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m08:36:02.649622 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:36:02.650621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:02.652615 [debug] [Thread-2 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e"
[0m08:36:02.653617 [debug] [Thread-3 (]: Using duckdb connection "test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58"
[0m08:36:02.654611 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m08:36:02.656605 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select merchant_clean
from "personal_finance"."main"."stg_transactions"
where merchant_clean is null



  
  
      
    ) dbt_internal_test
[0m08:36:02.656605 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:36:02.657602 [debug] [Thread-3 (]: On test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58: BEGIN
[0m08:36:02.658679 [debug] [Thread-4 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c"
[0m08:36:02.660665 [debug] [Thread-1 (]: Using duckdb connection "test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957"
[0m08:36:02.661663 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:36:02.662660 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select transaction_date
from "personal_finance"."main"."stg_transactions"
where transaction_date is null



  
  
      
    ) dbt_internal_test
[0m08:36:02.664655 [debug] [Thread-1 (]: On test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select txn_id
from "personal_finance"."main"."stg_transactions"
where txn_id is null



  
  
      
    ) dbt_internal_test
[0m08:36:02.665651 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m08:36:02.666650 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m08:36:02.671636 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e: ROLLBACK
[0m08:36:02.672633 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m08:36:02.673674 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:36:02.673736 [debug] [Thread-3 (]: Using duckdb connection "test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58"
[0m08:36:02.674735 [debug] [Thread-2 (]: Failed to rollback 'test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e'
[0m08:36:02.677726 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c: ROLLBACK
[0m08:36:02.680884 [debug] [Thread-1 (]: On test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957: ROLLBACK
[0m08:36:02.681880 [debug] [Thread-3 (]: On test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    transaction_date as unique_field,
    count(*) as n_records

from "personal_finance"."main"."fct_burn_rate"
where transaction_date is not null
group by transaction_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:36:02.682878 [debug] [Thread-2 (]: On test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e: Close
[0m08:36:02.683874 [debug] [Thread-4 (]: Failed to rollback 'test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c'
[0m08:36:02.684871 [debug] [Thread-1 (]: Failed to rollback 'test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957'
[0m08:36:02.688861 [debug] [Thread-4 (]: On test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c: Close
[0m08:36:02.686866 [info ] [Thread-2 (]: 9 of 13 PASS not_null_stg_transactions_merchant_clean .......................... [[32mPASS[0m in 0.18s]
[0m08:36:02.690857 [debug] [Thread-1 (]: On test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957: Close
[0m08:36:02.690857 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m08:36:02.693849 [debug] [Thread-2 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e
[0m08:36:02.692851 [info ] [Thread-4 (]: 10 of 13 PASS not_null_stg_transactions_transaction_date ....................... [[32mPASS[0m in 0.17s]
[0m08:36:02.699833 [debug] [Thread-3 (]: On test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58: ROLLBACK
[0m08:36:02.695845 [info ] [Thread-1 (]: 11 of 13 PASS not_null_stg_transactions_txn_id ................................. [[32mPASS[0m in 0.16s]
[0m08:36:02.700830 [debug] [Thread-2 (]: Began running node test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7
[0m08:36:02.704815 [debug] [Thread-4 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c
[0m08:36:02.705815 [debug] [Thread-3 (]: Failed to rollback 'test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58'
[0m08:36:02.707808 [debug] [Thread-1 (]: Finished running node test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957
[0m08:36:02.708806 [info ] [Thread-2 (]: 13 of 13 START test unique_stg_transactions_txn_id ............................. [RUN]
[0m08:36:02.710804 [debug] [Thread-3 (]: On test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58: Close
[0m08:36:02.712798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.personal_finance_tracker.not_null_stg_transactions_merchant_clean.0e5c23f37e, now test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7)
[0m08:36:02.714789 [debug] [Thread-2 (]: Began compiling node test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7
[0m08:36:02.713795 [info ] [Thread-3 (]: 12 of 13 PASS unique_fct_burn_rate_transaction_date ............................ [[32mPASS[0m in 0.15s]
[0m08:36:02.723765 [debug] [Thread-2 (]: Writing injected SQL for node "test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7"
[0m08:36:02.725761 [debug] [Thread-3 (]: Finished running node test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58
[0m08:36:02.727755 [debug] [Thread-2 (]: Began executing node test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7
[0m08:36:02.738726 [debug] [Thread-2 (]: Writing runtime sql for node "test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7"
[0m08:36:02.742715 [debug] [Thread-2 (]: Using duckdb connection "test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7"
[0m08:36:02.744709 [debug] [Thread-2 (]: On test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7: BEGIN
[0m08:36:02.745707 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:36:02.747701 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m08:36:02.748699 [debug] [Thread-2 (]: Using duckdb connection "test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7"
[0m08:36:02.749696 [debug] [Thread-2 (]: On test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "personal_finance_tracker", "target_name": "dev", "node_id": "test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    txn_id as unique_field,
    count(*) as n_records

from "personal_finance"."main"."stg_transactions"
where txn_id is not null
group by txn_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m08:36:02.759677 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m08:36:02.762665 [debug] [Thread-2 (]: On test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7: ROLLBACK
[0m08:36:02.763662 [debug] [Thread-2 (]: Failed to rollback 'test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7'
[0m08:36:02.764659 [debug] [Thread-2 (]: On test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7: Close
[0m08:36:02.765656 [info ] [Thread-2 (]: 13 of 13 PASS unique_stg_transactions_txn_id ................................... [[32mPASS[0m in 0.05s]
[0m08:36:02.768654 [debug] [Thread-2 (]: Finished running node test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7
[0m08:36:02.771640 [debug] [MainThread]: Using duckdb connection "master"
[0m08:36:02.772638 [debug] [MainThread]: On master: BEGIN
[0m08:36:02.774692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:36:02.775796 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m08:36:02.776794 [debug] [MainThread]: On master: COMMIT
[0m08:36:02.777790 [debug] [MainThread]: Using duckdb connection "master"
[0m08:36:02.777790 [debug] [MainThread]: On master: COMMIT
[0m08:36:02.779799 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:36:02.780782 [debug] [MainThread]: On master: Close
[0m08:36:02.781780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:36:02.782778 [debug] [MainThread]: Connection 'list_personal_finance_main' was properly closed.
[0m08:36:02.783774 [debug] [MainThread]: Connection 'test.personal_finance_tracker.not_null_stg_transactions_txn_id.76ab070957' was properly closed.
[0m08:36:02.785768 [debug] [MainThread]: Connection 'test.personal_finance_tracker.unique_stg_transactions_txn_id.be9177e8f7' was properly closed.
[0m08:36:02.786768 [debug] [MainThread]: Connection 'test.personal_finance_tracker.unique_fct_burn_rate_transaction_date.d2bab0fc58' was properly closed.
[0m08:36:02.788761 [debug] [MainThread]: Connection 'test.personal_finance_tracker.not_null_stg_transactions_transaction_date.353bde368c' was properly closed.
[0m08:36:02.790174 [info ] [MainThread]: 
[0m08:36:02.791197 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m08:36:02.796160 [debug] [MainThread]: Command end result
[0m08:36:02.859670 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\manifest.json
[0m08:36:02.862654 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\personal_finance_tracker\personal_finance_tracker\target\semantic_manifest.json
[0m08:36:02.875620 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\personal_finance_tracker\personal_finance_tracker\target\run_results.json
[0m08:36:02.876618 [info ] [MainThread]: 
[0m08:36:02.878613 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:36:02.879622 [info ] [MainThread]: 
[0m08:36:02.880607 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m08:36:02.883599 [debug] [MainThread]: Command `dbt test` succeeded at 08:36:02.883599 after 3.63 seconds
[0m08:36:02.885594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC1E2A390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC1E23550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABAF2D010>]}
[0m08:36:02.886592 [debug] [MainThread]: Flushing usage events
[0m08:36:03.808442 [debug] [MainThread]: An error was encountered while trying to flush usage events
